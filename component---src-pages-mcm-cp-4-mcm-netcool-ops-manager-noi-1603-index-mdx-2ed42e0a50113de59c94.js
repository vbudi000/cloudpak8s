(window.webpackJsonp=window.webpackJsonp||[]).push([[86],{"013z":function(e,t,n){"use strict";n("KKXr"),n("pIFo");var a=n("pOBw"),o=n("q1tI"),r=n.n(o),l=n("NmYn"),i=n.n(l),c=n("OKom"),s=n("k4MR"),b=n("TSYQ"),p=n.n(b),m=n("QH2O"),u=n("qKvR"),d=function(e){var t,n=e.title,a=e.tabs,o=void 0===a?[]:a;return Object(u.b)("div",{className:p()(m.pageHeader,(t={},t[m.withTabs]=o.length,t))},Object(u.b)("div",{className:"bx--grid"},Object(u.b)("div",{className:"bx--row"},Object(u.b)("div",{className:"bx--col-lg-12"},Object(u.b)("h1",{id:"page-title",className:m.text},n)))))},h=n("pEPl"),O=n("BAC9"),g=function(e){var t=e.relativePagePath,n=e.repository,a=h.data.site.siteMetadata.repository,o=n||a,r=o.baseUrl,l=o.subDirectory,i=r+"/edit/"+o.branch+l+"/src/pages"+t;return r?Object(u.b)("div",{className:"bx--row "+O.row},Object(u.b)("div",{className:"bx--col"},Object(u.b)("a",{className:O.link,href:i},"Edit this page on GitHub"))):null},j=n("FCXl"),N=(n("Oyvg"),n("Wbzz")),f=n("I8xM");var y=function(e){var t,n;function a(){return e.apply(this,arguments)||this}return n=e,(t=a).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,a.prototype.render=function(){var e=this.props,t=e.tabs,n=e.slug,a=n.split("/").filter(Boolean).slice(-1)[0],o=t.map((function(e){var t,o=i()(e,{lower:!0}),r=o===a,l=new RegExp(a+"(?!-)"),c=n.replace(l,o);return Object(u.b)("li",{key:e,className:p()((t={},t[f.selectedItem]=r,t),f.listItem)},Object(u.b)(N.Link,{className:f.link,to:""+c},e))}));return Object(u.b)("div",{className:f.tabsContainer},Object(u.b)("div",{className:"bx--grid"},Object(u.b)("div",{className:"bx--row"},Object(u.b)("div",{className:"bx--col-lg-12 bx--col-no-gutter"},Object(u.b)("nav",null,Object(u.b)("ul",{className:f.list},o))))))},a}(r.a.Component),v=n("MjG9");t.a=function(e){var t=e.pageContext,n=e.children,o=e.location,r=e.Title,l=t.frontmatter,b=void 0===l?{}:l,p=t.relativePagePath,m=t.titleType,h=b.tabs,O=b.title,N=b.theme,f=b.description,C=b.keywords,w=a.data.site.pathPrefix,k=w?o.pathname.replace(w,""):o.pathname,I=h?k.split("/").filter(Boolean).slice(-1)[0]||i()(h[0],{lower:!0}):"";return Object(u.b)(s.a,{tabs:h,homepage:!1,theme:N,pageTitle:O,pageDescription:f,pageKeywords:C,titleType:m},Object(u.b)(d,{title:r?Object(u.b)(r,null):O,label:"label",tabs:h}),h&&Object(u.b)(y,{slug:k,tabs:h,currentTab:I}),Object(u.b)(v.a,{padded:!0},n,Object(u.b)(g,{relativePagePath:p})),Object(u.b)(j.a,{pageContext:t,location:o,slug:k,tabs:h,currentTab:I}),Object(u.b)(c.a,null))}},pEPl:function(e){e.exports=JSON.parse('{"data":{"site":{"siteMetadata":{"repository":{"baseUrl":"https://github.com/ibm-cloud-architecture/cloudpak8s","subDirectory":"/","branch":"master"}}}}}')},pOBw:function(e){e.exports=JSON.parse('{"data":{"site":{"pathPrefix":""}}}')},vThZ:function(e,t,n){"use strict";n.r(t),n.d(t,"_frontmatter",(function(){return i})),n.d(t,"default",(function(){return p}));n("91GP"),n("rGqo"),n("yt8O"),n("Btvt"),n("RW0V"),n("q1tI");var a=n("7ljp"),o=n("013z");n("qKvR");function r(){return(r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var l,i={},c=(l="InlineNotification",function(e){return console.warn("Component "+l+" was not imported, exported, or provided by MDXProvider as global scope"),Object(a.b)("div",e)}),s={_frontmatter:i},b=o.a;function p(e){var t=e.components,n=function(e,t){if(null==e)return{};var n,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,["components"]);return Object(a.b)(b,r({},s,n,{components:t,mdxType:"MDXLayout"}),Object(a.b)("p",null,Object(a.b)("a",r({parentName:"p"},{href:"/mcm/cp4mcm_netcool_ops_manager"}),"Back to NOI current version - 1.6.1")),Object(a.b)("h2",null,Object(a.b)("strong",{parentName:"h2"},"Solution Overview")),Object(a.b)("p",null,"The following section describe the installation procedure for NOI version 1.6.0.3 and ASM version 1.1.7."),Object(a.b)("p",null,"There are different options that you can choose when installing the\nNetcool Ops Manager.  For example, you can choose an online install or an\noffline install.  "),Object(a.b)("p",null,"This playbook is written from the author’s experience of installing the product.\nOne of the challenges for the engineer preparing the installation of Netcool\nOps Manager for the first time is that the many different installation options\nthat can lead to confusion.  To address this, we present this playbook as\nprescriptively as possible, following the most common options: ",Object(a.b)("strong",{parentName:"p"}," offline\ninstallation of Agile Service Manager (ASM) and\nNetcool Operations Insight (NOI) on OpenShift Container Platform\nversion 4.3 for\nthe Production environment (size 1) "),".  At the time of this writing, OCP version 4.3 is the current supported OCP platform by Netcool Ops Manager."),Object(a.b)("p",null,"The flow of the installation is as follows:"),Object(a.b)("img",{src:"/assets/img/cp4mcm/cp4mcm_noi_installation.png",alt:"CP4MCM Netcool Ops Manager Installation Flow"}),Object(a.b)("ol",null,Object(a.b)("li",{parentName:"ol"},Object(a.b)("a",r({parentName:"li"},{href:"#nom-ocp"}),"Preparing the Openshift 4.3 environment")),Object(a.b)("li",{parentName:"ol"},Object(a.b)("a",r({parentName:"li"},{href:"#nom-bastion"}),"Preparing the installation/bastion workstation")),Object(a.b)("li",{parentName:"ol"},Object(a.b)("a",r({parentName:"li"},{href:"#nom-ldap"}),"Preparing the LDAP server")),Object(a.b)("li",{parentName:"ol"},Object(a.b)("a",r({parentName:"li"},{href:"#nom-download"}),"Downloading the Netcool Ops Manager software")),Object(a.b)("li",{parentName:"ol"},Object(a.b)("a",r({parentName:"li"},{href:"#nom-common"}),"Ensuring that IBM Common Platform Common Services is available")," "),Object(a.b)("li",{parentName:"ol"},Object(a.b)("a",r({parentName:"li"},{href:"#nom-registry"}),"Exposing OCP External Registry Access")),Object(a.b)("li",{parentName:"ol"},Object(a.b)("a",r({parentName:"li"},{href:"#nom-inception"}),"Configuring the icp-inception at the bastion workstation")),Object(a.b)("li",{parentName:"ol"},Object(a.b)("a",r({parentName:"li"},{href:"#nom-run"}),"Running the icp-inception to install IBM Common Services")),Object(a.b)("li",{parentName:"ol"},Object(a.b)("a",r({parentName:"li"},{href:"#nom-auth"}),"Configuring IBM Common Services Authentication")),Object(a.b)("li",{parentName:"ol"},Object(a.b)("a",r({parentName:"li"},{href:"#nom-cli"}),"Getting the cloudctl and helm clients from IBM Common Services")),Object(a.b)("li",{parentName:"ol"},Object(a.b)("a",r({parentName:"li"},{href:"#nom-asm"}),"Installing Agile Service Manager")),Object(a.b)("li",{parentName:"ol"},Object(a.b)("a",r({parentName:"li"},{href:"#nom-noi"}),"Installing Netcool Operations Insight")),Object(a.b)("li",{parentName:"ol"},Object(a.b)("a",r({parentName:"li"},{href:"#nom-post"}),"Post installation steps"))),Object(a.b)("p",null,"Each step is detailed as follows:"),Object(a.b)("a",{name:"nom-ocp"}),Object(a.b)("h2",null,"Preparing the Openshift 4.3 environment"),Object(a.b)("h3",null,"Sizing"),Object(a.b)("p",null,"The online documentation (links provided below)\nprovides sizing guidelines.  Separate sizing\nguidelines are available depending on whether you are installing for a\nProof of Concept (PoC) or\nfor a production environment."),Object(a.b)("p",null,"Based on the installation that we performed, and choosing the\n“production size” option or “size 1”, you need at least the following\nresources to\nrun the IBM Common Services, ASM and NOI."),Object(a.b)("h4",null,"CPU and Memory"),Object(a.b)("p",null,"Recommended minimal worker nodes sizing:"),Object(a.b)("table",null,Object(a.b)("thead",{parentName:"table"},Object(a.b)("tr",{parentName:"thead"},Object(a.b)("th",r({parentName:"tr"},{align:null}),"Description"),Object(a.b)("th",r({parentName:"tr"},{align:null}),"Quantity"))),Object(a.b)("tbody",{parentName:"table"},Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",r({parentName:"tr"},{align:null}),"Number of worker nodes"),Object(a.b)("td",r({parentName:"tr"},{align:null}),"6")),Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",r({parentName:"tr"},{align:null}),"Number of vCPUs per worker node"),Object(a.b)("td",r({parentName:"tr"},{align:null}),"20")),Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",r({parentName:"tr"},{align:null}),"Minimum memory per worker node"),Object(a.b)("td",r({parentName:"tr"},{align:null}),"24 GB")))),Object(a.b)("p",null,"In preparing for this playbook, we installed the system into a cluster\nwith as little\nas possible resources.  With 100 vCPUs (5 worker nodes with 20 vCPU each),\nwe saw that some of the pods could not be loaded, because there\nwas not enough CPU\nresource.  The listed CPU and Memory requirements are the minimum.\nThe availability of more worker nodes is recommended."),Object(a.b)("p",null,"More information on sizing can be found at the following sites:"),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},Object(a.b)("a",r({parentName:"li"},{href:"https://www.ibm.com/support/knowledgecenter/SSTPTP_1.6.0/com.ibm.netcool_ops.doc/soc/integration/reference/soc_sizing_full.html"}),"NOI Sizing Guidelines")),Object(a.b)("li",{parentName:"ul"},Object(a.b)("a",r({parentName:"li"},{href:"https://www.ibm.com/support/knowledgecenter/SS9LQB_1.1.7/Reference/r_asm_ocp_sizing.html"}),"ASM Sizing Guidelines"))),Object(a.b)("h4",null,"Storage Capacity"),Object(a.b)("p",null,"If you are installing into OCP 4.3, then ",Object(a.b)("strong",{parentName:"p"},"Rook/Ceph")," or\n",Object(a.b)("strong",{parentName:"p"},"Openshift Container Storage (OCS)"),", with ",Object(a.b)("strong",{parentName:"p"},"RADOS Block Device (RBD)")," storage\nclass, is the default supported OCP Storage solution.  We recommend Rook/Ceph\nas the dynamic storage solution for Netcool Ops Manager."),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Image Registry Storage"),": As you are preparing the OCP cluster, please allow at least 150GB of\nimage-registry storage for the Netcool Ops Manager. This is in addition to\nyour normal image-registry requirements for your other OCP’s purpose. "),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Persistent Volume Claim"),": If you are deploying the Openshift Container Storage (OCS), then OCS\ncreates a default 2 TB Rook/Ceph/RDB block storage.  For an initial\nproduction installation of Netcool Ops Manager, you need about 800 GB of\nstorage (PVC) space, in addition to the image-registry storage.  Please take\nnote of the storage class name. You need this later during the\ninstallation."),Object(a.b)(c,{mdxType:"InlineNotification"},Object(a.b)("p",null,"Prior to OCP 4.3, storage could be a challenge.  GlusterFS or NFS have been\nfound to not be a recommended storage solution for Netcool Ops Manager. The\ncurrent installation scripts suggested Local Storage.  So if Rook/Ceph is not\navailable, then use Local Storage.")),Object(a.b)("p",null,"If you need help with installing your OCP environment, please see this\nplaybook’s section on ",Object(a.b)("a",r({parentName:"p"},{href:"../../ocp/introduction/"}),"installing OpenShift"),"."),Object(a.b)("a",{name:"nom-bastion"}),Object(a.b)("h2",null,"Preparing the installation/bastion workstation."),Object(a.b)("p",null,"You need one bastion workstation that you can ",Object(a.b)("inlineCode",{parentName:"p"},"ssh")," into as the machine\nfrom which",Object(a.b)("br",{parentName:"p"}),"\n","you run the installation.  You also need a Docker runtime to run the\ninstallation script.  An RHEL 7.x Virtual Machine with 4vCPU and 16 GB of\nRAM is a good candidate for the bastion workstation.  "),Object(a.b)(c,{mdxType:"InlineNotification"},Object(a.b)("p",null,"RHEL 8 comes with a ",Object(a.b)("inlineCode",{parentName:"p"},"podman")," package that replaces Docker, so it is not\nrecommended as the bastion workstation platform.")),Object(a.b)("p",null,"You need at least 30 GB under /tmp and 60GB under /var/lib/docker to run the\ninstallation scripts.  If you do not have 60GB available in the /var filesystem\nto run the install\nscript, you can configure docker to use a different directory."),Object(a.b)("p",null,"You need to download and unpack the 4 command-line tools:"),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},Object(a.b)("inlineCode",{parentName:"li"},"oc")," and ",Object(a.b)("inlineCode",{parentName:"li"},"kubectl")),Object(a.b)("li",{parentName:"ul"},Object(a.b)("inlineCode",{parentName:"li"},"docker")),Object(a.b)("li",{parentName:"ul"},Object(a.b)("inlineCode",{parentName:"li"},"cloudctl")),Object(a.b)("li",{parentName:"ul"},Object(a.b)("inlineCode",{parentName:"li"},"helm"))),Object(a.b)("p",null,"Steps to get the ",Object(a.b)("inlineCode",{parentName:"p"},"cloudctl")," and ",Object(a.b)("inlineCode",{parentName:"p"},"helm")," command lines are provided in a\nlater section of this playbook."),Object(a.b)("h3",null,"Getting the oc and kubectl command lines"),Object(a.b)("p",null,"You download oc and kubectl from your OCP cluster. The kubectl executable is\na symbolic link of the oc executable.  The following\n",Object(a.b)("a",r({parentName:"p"},{href:"https://docs.openshift.com/container-platform/3.9/cli_reference/get_started_cli.html"}),"documentation from Red Hat"),"\ndescribes the steps to get started with the ",Object(a.b)("inlineCode",{parentName:"p"},"oc")," and ",Object(a.b)("inlineCode",{parentName:"p"},"kubectl")," command line\ninterface."),Object(a.b)("h3",null,"Getting the docker command line"),Object(a.b)("p",null,"You can get the docker command line from the RHEL 7 extra repository.  Ensure that your\nyum repository is set up and run the following command."),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{}),"sudo yum install docker -y\n")),Object(a.b)("p",null,"Once you have install docker, you need to enable and run the docker daemon."),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{}),"sudo systemctl enable docker.service\nsudo systemctl start docker.service \n")),Object(a.b)("p",null,"Verify that your docker environment is ready by executing:"),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{}),"docker --version\n")),Object(a.b)("a",{name:"nom-vardocker"}),Object(a.b)("h4",null,"Reassigning /var/lib/docker"),Object(a.b)("p",null,"You need to ensure that you have at least 60GB under /var and 30GB under\n/tmp when\nyou execute the NOI ",Object(a.b)("inlineCode",{parentName:"p"},"cloudctl catalog load")," later.  If you do not have that\ncapacity on /var then you can configure docker to use a different\ndirectory with the following steps."),Object(a.b)("p",null,"If you are using RHEL 7.x, then you can do the following."),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},"Stop the docker processes")),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{}),"sudo docker stop $(docker ps -q)\n")),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},"Stop the docker daemon")),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{}),"sudo systemctl stop docker\n")),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},"To verify: Unmount all docker mount points, and ensure all docker processes\nare not running")),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{}),"sudo umount /var/lib/docker/devicemapper/mnt/*\nps aux | grep -i docker | grep -v grep\n")),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},"Edit the ",Object(a.b)("inlineCode",{parentName:"li"},"/etc/sysconfig/docker")," file, and add\nthe -g <NEW_DIRECTORY_NAME> to the ",Object(a.b)("inlineCode",{parentName:"li"},"OPTIONS")," assignement.  For example.")),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{}),'# Modify these options if you want to change the way the docker daemon runs\nOPTIONS=\'--selinux-enabled --log-driver=journald --signature-verification=false -D -g "/<NEW/MOUNT/POINT>/".\n')),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},"Restart the systemctl daemon")),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{}),"sudo systemctl daemon-reload\n")),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},"Copy the existing docker files over from /var/lib/docker to the new\ndirectory. In this example the new directory is /opt/docker, replace it with your path.")),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{}),"sudo rsync -aqxP /var/lib/docker /opt/docker\n")),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},"Set SE linux labels")),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{}),"sudo restorecon /opt/docker\n")),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},"Restart docker")),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{}),"sudo systemctl start docker\n")),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},"Verify that the -g options is listed.")),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{}),"ps aux | grep -i docker | grep -v grep\n")),Object(a.b)("a",{name:"nom-ldap"}),Object(a.b)("h2",null,"Preparing the LDAP server"),Object(a.b)("p",null,"You need to provide details of your LDAP server for the following components:"),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},"OCP Cluster"),Object(a.b)("li",{parentName:"ul"},"IBM Common Platform (ICP) Console of IBM Common Services."),Object(a.b)("li",{parentName:"ul"},"NOI Proxy configuration.")),Object(a.b)("p",null,"Setting up your LDAP server is a common requirement across all  Cloud Paks,\nso it is not detailed here.  "),Object(a.b)("p",null,"During the installation, you will need to specify the following information, so\nget the information before you start the helm chart configuration:"),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},"Your Base Distinguished name."),Object(a.b)("li",{parentName:"ul"},"Your LDAP URL."),Object(a.b)("li",{parentName:"ul"},"Your LDAP Bind User Name and Password."),Object(a.b)("li",{parentName:"ul"},"The filter to get the user information (User Filter and User ID map)."),Object(a.b)("li",{parentName:"ul"},"The filter to get the group information (Group Filter and Group ID map)."),Object(a.b)("li",{parentName:"ul"},"The filter to map a user to a group (Group member ID map).")),Object(a.b)("p",null,"One of the pods deployed by the NOI Helm Chart is an OpenLDAP pod. You can\nchoose to set up the OpenLDAP as a standalone repository or as a proxy to an\nexternal LDAP server.  If you choose to use the OpenLDAP pod as a proxy, then\nNetcool Ops Manager expects the external LDAP server to support the\nhierarchical LDAP structure.  In particular, the NOI LDAP configuration wants\nto use an ou (Organizational Unit).",Object(a.b)("br",{parentName:"p"}),"\n","More information on the NOI Proxy LDAP requirement can be found in the\n",Object(a.b)("a",r({parentName:"p"},{href:"https://www.ibm.com/support/knowledgecenter/SSTPTP_1.6.0/com.ibm.netcool_ops.doc/soc/admin/reference/managing_users_using_an_external_ldap_server.html"}),"IBM Knowledge Center"),"."),Object(a.b)(c,{mdxType:"InlineNotification"},Object(a.b)("p",null,"Note that since RHEL 7.4, the RHEL repository no longer distributes the OpenLDAP\nserver.  The default LDAP server for RHEL 7.5 onwards is the IPA (Identity, Policy, Audit) server. The\nIPA server only supports a flat LDIF structure. It does not support ",Object(a.b)("inlineCode",{parentName:"p"},"ou"),"\nso you can not use the IPA server as the external LDAP server for NOI.  This\ninformation can be found in the\n",Object(a.b)("a",r({parentName:"p"},{href:"https://access.redhat.com/solutions/4172491"}),"Red Hat Solutions")," documentation.")),Object(a.b)("a",{name:"nom-download"}),Object(a.b)("h2",null,"Downloading the Netcool Ops Manager software"),Object(a.b)("p",null,"The eAssemby for Netcool Ops Manager is "),Object(a.b)("table",null,Object(a.b)("thead",{parentName:"table"},Object(a.b)("tr",{parentName:"thead"},Object(a.b)("th",r({parentName:"tr"},{align:null}),"PartNo"),Object(a.b)("th",r({parentName:"tr"},{align:null}),"Description"),Object(a.b)("th",r({parentName:"tr"},{align:null}),"Size"),Object(a.b)("th",r({parentName:"tr"},{align:null}),"Number of images"))),Object(a.b)("tbody",{parentName:"table"},Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",r({parentName:"tr"},{align:null}),"CJ5MZEN"),Object(a.b)("td",r({parentName:"tr"},{align:null}),"IBM Netcool Operations Insight v1.6.0.3 Cloud Paks Multiplatform English eAssembly"),Object(a.b)("td",r({parentName:"tr"},{align:null}),"30 GB"),Object(a.b)("td",r({parentName:"tr"},{align:null}),"7")))),Object(a.b)("p",null,"To install ASM and NOI, you need to download the following components\nof the above eAssembly. "),Object(a.b)("table",null,Object(a.b)("thead",{parentName:"table"},Object(a.b)("tr",{parentName:"thead"},Object(a.b)("th",r({parentName:"tr"},{align:null}),"PartNo"),Object(a.b)("th",r({parentName:"tr"},{align:null}),"Description"),Object(a.b)("th",r({parentName:"tr"},{align:null}),"Size"),Object(a.b)("th",r({parentName:"tr"},{align:null}),"File name"))),Object(a.b)("tbody",{parentName:"table"},Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",r({parentName:"tr"},{align:null}),"CC5J3ML"),Object(a.b)("td",r({parentName:"tr"},{align:null}),"Common Services for 3.2.4 IBM Netcool Operations Insight 1.6.0.3 Multilingual"),Object(a.b)("td",r({parentName:"tr"},{align:null}),"7.4 GB"),Object(a.b)("td",r({parentName:"tr"},{align:null}),"COM_SVRCE3.2.4_NOI_1.6.0.3_ML.tar.gz")),Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",r({parentName:"tr"},{align:null}),"CC686ML"),Object(a.b)("td",r({parentName:"tr"},{align:null}),"IBM Netcool Agile Service Manager v1.1.7 - Containers for IBM Cloud Private with Red Hat Enterprise Linux OpenShift Multilingual"),Object(a.b)("td",r({parentName:"tr"},{align:null}),"3.3 GB"),Object(a.b)("td",r({parentName:"tr"},{align:null}),"NOI_ASM_V1.1.7_FOR_ICP_ML.tar.gz")),Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",r({parentName:"tr"},{align:null}),"CC5IZML"),Object(a.b)("td",r({parentName:"tr"},{align:null}),"IBM Netcool Operations Insight 1.6.0.3 Operations Management - Containers for IBM Cloud Private with Red Hat Enterprise Linux OpenShift Multilingual"),Object(a.b)("td",r({parentName:"tr"},{align:null}),"13.1 GB"),Object(a.b)("td",r({parentName:"tr"},{align:null}),"NOI_V1.6.0.3_OM_FOR_ICP_ML.tar.gz")))),Object(a.b)("a",{name:"nom-common"}),Object(a.b)("h2",null,"Ensuring that IBM Cloud Platform Common Services is available"),Object(a.b)("p",null,"If you are installing into an Openshift cluster with Cloud Pak for MCM\nalready installed, then skip the next few steps and go to the\n",Object(a.b)("a",r({parentName:"p"},{href:"#nom-asm"}),"Installing Agile Service Manager"),"\nsection, otherwise install IBM Common Services as described next."),Object(a.b)("a",{name:"nom-registry"}),Object(a.b)("h2",null,"Exposing OCP External Registry Access"),Object(a.b)("p",null,"By default, OCP does not expose its Image registry to external access.\nYou need to patch the image registry to create a default route. As a route,\nthe default route allows external acess to the OCP image registry. You need\nthis to load the image from your bastion server."),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{}),'oc patch configs.imageregistry.operator.openshift.io/cluster --patch \'{"spec":{"defaultRoute":true}}\' --type=merge\n')),Object(a.b)("p",null,"If your OCP cluster certificate is self signed, then you need the client to\ndownload the certificate to trust.\nCopy the image registry certificate to your bastion server by performing the\nfollowing steps:"),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{}),"DOCKER_REGISTRY=\"$(kubectl get route -n openshift-image-registry default-route -o jsonpath='{.spec.host}')\"\nmkdir -p /etc/docker/certs.d/$DOCKER_REGISTRY\nopenssl s_client -showcerts -servername $DOCKER_REGISTRY -connect $DOCKER_REGISTRY:443 2>/dev/null | openssl x509 -inform pem > /etc/docker/certs.d/$DOCKER_REGISTRY/ca.crt\n")),Object(a.b)("p",null,"Test the image registry default route by performing a docker login."),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{}),"docker login -u $(oc whoami) -p $(oc whoami -t) ${OCP_REGISTRY}\n")),Object(a.b)(c,{mdxType:"InlineNotification"},Object(a.b)("p",null,"Note that for the above ",Object(a.b)("inlineCode",{parentName:"p"},"docker login")," to work, you must first perform an\n",Object(a.b)("inlineCode",{parentName:"p"},"oc login")," using a token. You do this by copying\nthe ",Object(a.b)("inlineCode",{parentName:"p"},"oc login")," with the token from the\nOCP Web Interface and pasting and running it from your command line.\nIf you perform an ",Object(a.b)("inlineCode",{parentName:"p"},"oc login")," using the certificate defined\nthrough the ",Object(a.b)("inlineCode",{parentName:"p"},"KUBECONFIG")," environment variable, then the token will be empty, and\nyour docker login will fail. ")),Object(a.b)("a",{name:"nom-inception"}),Object(a.b)("h2",null,"Configuring the icp-inception at the bastion workstation"),Object(a.b)("p",null,"You install IBM Common Services by configuring and running the\nicp-inception on docker.  Start by loading the IBM Common Services downloaded\npackage to the bastion server."),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{}),"tar xf common-services-boeblingen-2002-x86_64.tar.gz -O | sudo docker load\n")),Object(a.b)("p",null,"Create the cluster configuration from the icp-inception."),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{}),"mkdir cluster\nsudo docker run --rm -v $(pwd)/cluster:/data -e LICENSE=accept ibmcom/icp-inception-amd64:3.2.4 cp cluster/config.yaml /data/config.yaml\n")),Object(a.b)("p",null,"Edit the cluster configuration file.\nYou need to replace the place holder in the section below. Specify the other\noptional components in the configuration file as required."),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{}),"cluster_nodes:\n  master:\n    - <REPLACE_WITH_ONE_OF_YOUR_WORKER_NODE_NAME>\n  proxy:\n    - <REPLACE_WITH_ONE_OF_YOUR_WORKER_NODE_NAME>\n  management:\n    - <REPLACE_WITH_ONE_OF_YOUR_WORKER_NODE_NAME>\n\nstorage_class: <REPLACE_WITH_YOUR_STORAGE_CLASS>\n\ndefault_admin_user: <REPLACE_WITH_YOUR_ADMIN_USER>\ndefault_admin_password: <REPLACE_WITH_YOUR_ADMIN_USER_PASSWORD>\npassword_rules:\n  - '(.*)'\n")),Object(a.b)("p",null,"Copy the kubeconfig file that the OCP installation created, to the cluster directory.  Now you are ready to perform the install."),Object(a.b)("a",{name:"nom-run"}),Object(a.b)("h2",null,"Running the icp-inception to install IBM Common Services"),Object(a.b)("p",null,"Change directory to the parent directory of the ",Object(a.b)("inlineCode",{parentName:"p"},"cluster")," directory, and run\nthe ",Object(a.b)("inlineCode",{parentName:"p"},"icp-inception")," playbook."),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{}),'sudo docker run --net=host -t -e LICENSE=accept -v "$(pwd)/cluster":/installer/cluster -v /var/run/docker.sock:/var/run/docker.sock ibmcom/icp-inception-amd64:3.2.4 addon -v\n')),Object(a.b)(c,{mdxType:"InlineNotification"},Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"}," Note:")," If you specify the ",Object(a.b)("inlineCode",{parentName:"p"},"default")," storage class in the config.yaml file\n(this is the default value), and it does not exist, the pod ",Object(a.b)("inlineCode",{parentName:"p"},"icp-mongodb-0"),"\nwhich is part of ",Object(a.b)("inlineCode",{parentName:"p"},"icp-mongodb")," stateful set will not be able to continue, as\nit can not create its Persistent Volume Claim (PVC).\nTherefore, it is recommended that you explicitly specify the\nstorage class name in the config.yaml file, rather than using ‘default’.")),Object(a.b)("p",null,"More information on configuring and running the IBM Common Service can be found in the ",Object(a.b)("a",r({parentName:"p"},{href:"https://www.ibm.com/support/knowledgecenter/SSTPTP_1.6.0/com.ibm.netcool_ops.doc/csd/installer/3.2.2/installation-NOI.html"}),"IBM Knowledge Center")),Object(a.b)("a",{name:"nom-auth"}),Object(a.b)("h2",null,"Configuring IBM Common Services Authentication"),Object(a.b)("p",null,"While optional at this stage of the installation, if you use external LDAP,\nwe recommend to verify that the connection is working."),Object(a.b)("p",null,"Once the icp-inception is completed successfully, your IBM Common Services\nshould be up. Get the URL to your IBM Common Services, by checking the OCP\nroute."),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{}),"oc get route -n kube-system\n")),Object(a.b)("p",null,"You are looking for a route name starting with ",Object(a.b)("inlineCode",{parentName:"p"},"icp-console"),". The fully\nqualified domain name will look like\n",Object(a.b)("inlineCode",{parentName:"p"},"icp-console.apps.<YOUR_OCP_BASE_DNS_NAMES>"),"."),Object(a.b)("p",null,"Log in to IBM Common Services using the URL and the user name and password\nthat you specified in the config.yaml file."),Object(a.b)("p",null,"Set up your LDAP connection, and create the user by following the instructions\nin the\n",Object(a.b)("a",r({parentName:"p"},{href:"https://www.ibm.com/support/knowledgecenter/en/SSFC4F_1.3.0/iam/3.4.0/configure_ldap.html"}),"MCM Knowledge Center"),"."),Object(a.b)("a",{name:"nom-client"}),Object(a.b)("h2",null,"Getting the cloudctl and helm clients from IBM Common Services"),Object(a.b)("p",null,"Get your cloudctl client, log in to the IBM Common Services dashboard,\ncopy the curl command to download cloudctl to your bastion server, paste it\nto your command line, and then run the curl command. Change the mode of the\ncloudctl file to executable, and then move them to a directory in your\ncommand search path.  Verify that cloudctl is available by running it with a\nversion switch."),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{}),"curl -kLo cloudctl-linux-amd64-v3.2.4-1675 https://icp-console.apps.csmo-noi.ocp.csplab.local:443/api/cli/cloudctl-linux-amd64\nchmod 755 cloudctl-linux-amd64-v3.2.4-1675 \nmv cloudctl-linux-amd64-v3.2.4-1675 /usr/local/bin/cloudctl\ncloudctl version\n")),Object(a.b)("p",null,"Do a similar thing to download the helm client."),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{}),"curl -kLo helm-linux-amd64-v2.12.3.tar.gz https://icp-console.apps.csmo-noi.ocp.csplab.local:443/api/cli/helm-linux-amd64.tar.gz\nmkdir helm\ntar xvzf helm-linux-amd64-v2.12.3.tar.gz -C helm\nmv helm/linux-amd64/helm /usr/local/bin\n")),Object(a.b)("p",null,"Initialize your helm client. "),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{}),"export HELM_HOME=~/.helm\nhelm init --client-only\n")),Object(a.b)("p",null,"Log in to the IBM Common Services dashboard, copy the login token, and\nlog in to IBM Common Services from the command line using ",Object(a.b)("inlineCode",{parentName:"p"},"cloudctl"),".",Object(a.b)("br",{parentName:"p"}),"\n","You need to perform a cloudctl login at least once, as it creates the\nnecessary certificate to access helm in the user’s ",Object(a.b)("inlineCode",{parentName:"p"},"$HOME/.helm")," directory.\nVerify that the helm CLI is configured correctly by running a ",Object(a.b)("inlineCode",{parentName:"p"},"helm version"),"\ncommand.  "),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{}),"cloudctl login -a https://icp-console.apps.<OCP_CLUSTER> -u <ICP-USER> -n kube-system --skip-ssl-validation\nhelm version --tls\n")),Object(a.b)("p",null,"You might also want to configure the ",Object(a.b)("inlineCode",{parentName:"p"},"HELM_HOME")," variable\nin your login profile."),Object(a.b)("p",null,"More information on configuring the ",Object(a.b)("inlineCode",{parentName:"p"},"cloudctl")," and ",Object(a.b)("inlineCode",{parentName:"p"},"helm")," command line\ninterfaces can be found in the\n",Object(a.b)("a",r({parentName:"p"},{href:"https://www.ibm.com/support/knowledgecenter/en/SSFC4F_1.3.0/cli/cli_guide_mcm.html"}),"MCM Knowledge Center"),"\ndocumentation."),Object(a.b)("a",{name:"nom-asm"}),Object(a.b)("h2",null,"Installing Agile Service Manager and Netcool Operations Insight"),Object(a.b)("p",null,"Throughout this section the following resource sample values are used:"),Object(a.b)("table",null,Object(a.b)("thead",{parentName:"table"},Object(a.b)("tr",{parentName:"thead"},Object(a.b)("th",r({parentName:"tr"},{align:null}),"Resource"),Object(a.b)("th",r({parentName:"tr"},{align:null}),"Sample Value"))),Object(a.b)("tbody",{parentName:"table"},Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",r({parentName:"tr"},{align:null}),"Namespace for ASM and NOI"),Object(a.b)("td",r({parentName:"tr"},{align:null}),"noins")),Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",r({parentName:"tr"},{align:null}),"Release name for ASM"),Object(a.b)("td",r({parentName:"tr"},{align:null}),"asmrel1")),Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",r({parentName:"tr"},{align:null}),"Release name for NOI"),Object(a.b)("td",r({parentName:"tr"},{align:null}),"noirel1")),Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",r({parentName:"tr"},{align:null}),"Storage Class name"),Object(a.b)("td",r({parentName:"tr"},{align:null}),"rook-ceph-block")),Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",r({parentName:"tr"},{align:null}),"Password for NOI"),Object(a.b)("td",r({parentName:"tr"},{align:null}),"Netcool2020")))),Object(a.b)("p",null,"Please change the sample values if necessary during your installation.  "),Object(a.b)("h3",null,"Creating the namespace"),Object(a.b)("p",null,"Create a namespace (also referred to as project in OCP) for your NOI and ASM\ninstallations."),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{}),"oc new-project noins\n")),Object(a.b)(c,{mdxType:"InlineNotification"},Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"}," Note"),": NOI and ASM must be installed in the same namespace.")),Object(a.b)("h4",null,"Day 2 Operations: Pod Placement / Node Selection"),Object(a.b)("p",null,"As a Day 2 tip: It is recommended to create a pod placement rule to schedule\nall the NOI and ASM pods to run on a selection of worker nodes. One way to\ndo this is to define a ",Object(a.b)("strong",{parentName:"p"},"Node Selection")," policy by labeling the target worker\nnodes and then telling the scheduler to run the pods only on those worker\nnodes. All NOI and ASM pods are running in the same namespace. Thus, rather\nthan specifying the target label on each pod, it is more manageable to\nspecify the node selection on the namespace."),Object(a.b)("p",null,"Label the target worker nodes. If the name of the worker nodes that run the\nASM and NOI pods is ",Object(a.b)("inlineCode",{parentName:"p"},"worker1")," to ",Object(a.b)("inlineCode",{parentName:"p"},"worker6"),", then the worker nodes can be assigned\na label ",Object(a.b)("inlineCode",{parentName:"p"},"nodetorun=noiasm")," as follow (you can use your name-value pair):"),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{}),"for i in worker1 worker2 worker3 worker4 worker5 worker6\ndo \noc label nodes $i nodetorun=noiasm\ndone\n")),Object(a.b)("p",null,"You can then tell the scheduler to run all pods in the namespace ",Object(a.b)("inlineCode",{parentName:"p"},"noins")," by\nadding the label to the annotations sections of the namespace.  You can\nmodify the annotations by executing the following:"),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{}),"oc edit ns noins\n")),Object(a.b)("p",null,"Insert a line specifying the node selector:"),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{}),"    openshift.io/node-selector: nodetorun=noiasm\n")),Object(a.b)("p",null,"The following is an example of the edit namespace command, with the\nnode-selector already added at the end of the annotations section:"),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{}),'[root@bootstrap common]# oc edit ns noins\nnamespace/noins edited\n---------\n# Please edit the object below. Lines beginning with a \'#\' will be ignored,\n# and an empty file will abort the edit. If an error occurs while saving this file will be\n# reopened with the relevant failures.\n#\napiVersion: v1\nkind: Namespace\nmetadata:\n  annotations:\n    openshift.io/description: NOI Name Space\n    openshift.io/display-name: noins\n    openshift.io/requester: cadmin\n    openshift.io/sa.scc.mcs: s0:c25,c0\n    openshift.io/sa.scc.supplemental-groups: 1000600000/10000\n    openshift.io/sa.scc.uid-range: 1000600000/10000\n    openshift.io/node-selector: nodetorun=noiasm\n  creationTimestamp: "2020-05-01T07:42:33Z"\n  name: noins\n  resourceVersion: "8192651"\n  selfLink: /api/v1/namespaces/noins\n  uid: 7312be5a-ef8c-42f7-a3df-1e72ecb9b16e\nspec:\n  finalizers:\n  - kubernetes\nstatus:\n  phase: Active ~                 \n')),Object(a.b)("h3",null,"Assigning your release name"),Object(a.b)("p",null,"You need to specify a release name when you install the NOI and ASM charts.\nNOI and ASM come as separate charts, so you need different release names for\nthe NOI deployment and ASM deployment.  "),Object(a.b)("p",null,"The release name has to begin with a lowercase letter and end with an\nalphanumeric character. The release name can only contain hyphens and\nlowercase leters."),Object(a.b)("p",null,"During the installation of NOI, you need to specify the ASM release name.",Object(a.b)("br",{parentName:"p"}),"\n","Similarly, during the installation of ASM, you need to specify the NOI\nrelease name. Hence it is best to decide both release names before you start\nthe installation."),Object(a.b)("p",null,"We are using ",Object(a.b)("inlineCode",{parentName:"p"},"asmrel1")," and ",Object(a.b)("inlineCode",{parentName:"p"},"noirel1")," in the ongoing example.  Please change\nthem to your choice."),Object(a.b)("h3",null,"Loading the ASM image."),Object(a.b)("p",null,"Log in to IBM Common Services from the command line as a ",Object(a.b)("inlineCode",{parentName:"p"},"cluster-admin")," user.\nLoad the ASM image to the IBM Common Platform Catalog repository, by running\nthe following command from the directory where the\n",Object(a.b)("inlineCode",{parentName:"p"},"NOI_ASM_V1.1.7_FOR_ICP_ML.tar.gz")," image is located. "),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{}),"OCP_REGISTRY=$(oc get route -n openshift-image-registry default-route -o jsonpath='{.spec.host}')\ndocker login -u $(oc whoami) -p $(oc whoami -t) ${OCP_REGISTRY}\ncloudctl catalog load-archive --archive NOI_ASM_V1.1.7_FOR_ICP_ML.tar.gz --registry ${OCP_REGISTRY}/noins\n")),Object(a.b)(c,{mdxType:"InlineNotification"},Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"}," Note"),": During the loading of the image to the image registry, you need to\nhave enough space in /tmp and /var/lib/docker. If your /var mount point is\ntoo small, you can tell docker to use a different directory.\nPlease refer to the earlier ",Object(a.b)("a",r({parentName:"p"},{href:"#nom-vardocker"}),"section"),". ")),Object(a.b)("h3",null,"Creating the Cluster Role"),Object(a.b)("p",null,"ASM comes with several scripts that you need to execute before you start the\ninstallation."),Object(a.b)("p",null,"Unpack the ASM download then execute the scripts to create the cluster role\nand the create Security NameSpace:"),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{}),"tar xvzf NOI_ASM_V1.1.7_FOR_ICP_ML.tar.gz \ncd pak_extensions/pre-install/clusterAdministration\nbash createSecurityClusterPrereqs.sh\nbash createSecurityNamespacePrereqs.sh noins\n")),Object(a.b)("h3",null,"Creating the PVC"),Object(a.b)("p",null,"Edit the ",Object(a.b)("inlineCode",{parentName:"p"},"storageConfig.env")," file located in the ",Object(a.b)("inlineCode",{parentName:"p"},"clusterAdministration"),"\ndirectory.  Edit the ",Object(a.b)("inlineCode",{parentName:"p"},"storageConfig.env"),", and specify the 3 worker nodes.\nIf you want to use the Local Storage then run the PVC creation scripts."),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{}),"bash createStorageVolumes.sh noins asmrel1\n")),Object(a.b)("p",null,"The scripts will print out the additional actions that you need to perform.  "),Object(a.b)("h4",null,"Creating the  PVC using Rook/Ceph"),Object(a.b)("p",null,"As mentioned in the ",Object(a.b)("a",r({parentName:"p"},{href:"#nom-storage"}),"OCP Storage")," section at the beginning of this\nchapter, you can use the OCS or Rook/Ceph dynamic storage. To do this, you\nneed to change the yaml part of the script."),Object(a.b)("p",null,"Make a backup of the ",Object(a.b)("inlineCode",{parentName:"p"},"kubhelper.sh")," script and then edit it."),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{}),"cd ../../common\ncopy kubhelper.sh kubhelper.sh.bak\nvi kubhelper.sh\n")),Object(a.b)("p",null,"Search for the line starting with EOPV, and change the content between the\ntwo EOPVs, as follows:\n(Change the ",Object(a.b)("inlineCode",{parentName:"p"},"rook-ceph-block")," to your storage class name)."),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{}),"cat <<EOPV | ${CMD} apply -f -\napiVersion: v1\nkind: PersistentVolumeClaim\nmetadata:\n  name: ${4}\n  namespace: ${3}\n  labels:\n    release: ${2}\n  finalizers:\n  - kubernetes.io/pvc-protection\nspec:\n  accessModes:\n  - ReadWriteOnce\n  resources:\n    requests:\n      storage: ${5}Gi\n  storageClassName: rook-ceph-block\nEOPV\n")),Object(a.b)("p",null,"Run the script as before."),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{}),"cd ../pre-install/clusterAdministration\nbash createStorageVolumes.sh noins asmrel1\n")),Object(a.b)("p",null,"Verify that the PV and PVC are created:"),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{}),"oc project noins\noc get pv\noc get pvc\n")),Object(a.b)(c,{mdxType:"InlineNotification"},Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Note"),": The prefered PVC reclaim policy of ASM is the ",Object(a.b)("strong",{parentName:"p"},"Retain")," option.  If your default storage class reclaim policy is not “Retain” then you can patch the PV by using this command: "),Object(a.b)("p",null,Object(a.b)("inlineCode",{parentName:"p"},'oc patch pv <PV_NAME>  -p \'{"spec":{"persistentVolumeReclaimPolicy":"Retain"}}\''))),Object(a.b)("h3",null,"Installing Agile Service Manager from the catalog"),Object(a.b)("p",null,"The product documentation recommends installing Agile Service Manager before installing Netcool Operation Insight.  "),Object(a.b)("p",null,"Browse the IBM Common Services URL as a ",Object(a.b)("inlineCode",{parentName:"p"},"cluster-admin")," user,\nselect the catalog, and enter “netcool” in the search bar. The ASM chart\nshould be shown.  Select the chart and go through the chart configuration."),Object(a.b)("p",null,"There are 2 configuration options that you need to be careful with:"),Object(a.b)("table",null,Object(a.b)("thead",{parentName:"table"},Object(a.b)("tr",{parentName:"thead"},Object(a.b)("th",r({parentName:"tr"},{align:null}),"Configuration Options"),Object(a.b)("th",r({parentName:"tr"},{align:null}),"Values"))),Object(a.b)("tbody",{parentName:"table"},Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",r({parentName:"tr"},{align:null}),"Repository"),Object(a.b)("td",r({parentName:"tr"},{align:null}),"image-registry.openshift-image-registry.svc:5000/noins")),Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",r({parentName:"tr"},{align:null}),"Router domain"),Object(a.b)("td",r({parentName:"tr"},{align:null}),"apps.<YOUR_OCP_CLUSTER_NAME>")))),Object(a.b)(c,{mdxType:"InlineNotification"},Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Note"),": If you use the cloudctl catalog load command to load the ASM image,\nthen the repository is pre-populated with the external docker registry name.\nYou need to change this to the internal docker registry name. If you do not\nchange this to the internal registry name and you configured OCP using a\nself-signed certificate, then the installation of ASM will not even start, as the\nhelm process can not pull the image from the registry.")),Object(a.b)("h4",null,"ASM File Observer"),Object(a.b)("p",null,"If you choose to install the ASM File Observer during the initial installation of ASM, you may notice that the pod (",Object(a.b)("inlineCode",{parentName:"p"},"asmrel1-file-observer-*"),") is in ",Object(a.b)("em",{parentName:"p"},"Pending")," mode.  This may be caused by the PVC for the pod being released and since the reclaim policy is “Retain” it can not be bound again. Should this happen, then delete and recreate the PVC ",Object(a.b)("inlineCode",{parentName:"p"},"data-noirel1-file-observer"),".  The following yaml file might be helpful.  Remember to change the ",Object(a.b)("inlineCode",{parentName:"p"},"namespace"),", ",Object(a.b)("inlineCode",{parentName:"p"},"release"),", and ",Object(a.b)("inlineCode",{parentName:"p"},"storageClassName")," to your configuration.  Note that deleting and recreating the PVC will wipe out the content of the file system in the PVC.  Do not do this after the initial install of ASM, unless you are ok with the removal of the content of the file system."),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{}),"apiVersion: v1\nkind: PersistentVolumeClaim\nmetadata:\n  name: data-asmrel1-file-observer \n  namespace: noins\n  labels:\n    release: asmrel1\n  finalizers:\n  - kubernetes.io/pvc-protection\nspec:\n  accessModes:\n  - ReadWriteOnce\n  resources:\n    requests:\n      storage: 5Gi\n  storageClassName: rook-ceph-block\n")),Object(a.b)("p",null,"More information on installing Agile Service Manager can be found in the ",Object(a.b)("a",r({parentName:"p"},{href:"https://www.ibm.com/support/knowledgecenter/SS9LQB_1.1.7/welcome_page/kc_welcome-444.html"}),"IBM Knowledge Center"),"."),Object(a.b)("a",{name:"nom-noi"}),Object(a.b)("h2",null,"Installing Netcool Operations Insight"),Object(a.b)("h3",null,"Loading the NOI Catalog"),Object(a.b)("p",null,"You start the installation by loading the NOI image.  Unlike in ASM, for NOI,\nyou have to unpack the downloaded image first."),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{}),"tar xvzf /home/netcool/NOI_V1.6.0.3_OM_FOR_ICP_ML.tar.gz \ncloudctl catalog load-archive --archive ibm-netcool-prod-2.1.3-x86_64.tar.gz --registry default-route-openshift-image-registry.apps.<OCP_CLUSTER_BASE_DNS>/noins\n")),Object(a.b)("h3",null,"Creating the Service Account"),Object(a.b)("p",null,"Depending whether you will be running the helm chart as cluster admin or not,\nyou need to create the service account and assign the permissions to it.\nIf you are unsure, perform the following.\n(Change ",Object(a.b)("inlineCode",{parentName:"p"},"noins")," to your namespace):"),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{}),"oc create serviceaccount noi-service-account -n noins\noc adm policy add-scc-to-user ibm-privileged-scc system:serviceaccount:noins:noi-service-account\noc create role noiservice-reader --verb=update --verb=patch --verb=get --verb=list --verb=watch --resource=services -n noins\noc create rolebinding noiservice-reader --role noiservice-reader --serviceaccount noins:noi-service-account -n noins\noc create role noiconfigmap-reader --verb=update --verb=patch --verb=get --verb=list --verb=watch --resource=configmaps -n noins\noc create rolebinding noiconfigmap-reader --role noiconfigmap-reader --serviceaccount noins:noi-service-account -n noins\noc create role noisecret-creater --verb=list --verb=create --verb=get --resource=secrets -n noins\noc create rolebinding noisecret-creater --serviceaccount noins:noi-service-account --role noisecret-creater -n noins\noc create role releasename-redis --verb=get --verb=list --verb=update --verb=patch --verb=watch --resource=pods -n noins\noc create rolebinding releasename-redis --serviceaccount noins:noi-service-account --role releasename-redis -n noins\noc create role noiroute-reader --verb=update --verb=patch --verb=get --verb=list --verb=watch --resource=routes --resource=routes/custom-host -n noins\noc create rolebinding noiroute-reader --role noiroute-reader --serviceaccount noins:noi-service-account -n noins\n")),Object(a.b)("p",null,"Verify that you get a ",Object(a.b)("strong",{parentName:"p"},"yes")," to all of the following commands:"),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{}),"kubectl auth can-i patch services --namespace noins --as system:serviceaccount:noins:noi-service-account \nkubectl auth can-i watch configmaps --namespace noins --as system:serviceaccount:noins:noi-service-account\nkubectl auth can-i create secrets --namespace noins --as system:serviceaccount:noins:noi-service-account\nkubectl auth can-i create secrets --namespace noins --as system:serviceaccount:noins:noi-service-account\nkubectl auth can-i watch pods --namespace noins --as system:serviceaccount:noins:noi-service-account\nkubectl auth can-i patch routes --namespace noins --as system:serviceaccount:noins:noi-service-account\nkubectl auth can-i patch routes/custom-host --namespace noins --as system:serviceaccount:noins:noi-service-account\n")),Object(a.b)("h3",null,"Creating the passwords for the different NOI components."),Object(a.b)("p",null,"Perform the following steps if you want to choose the passwords for the NOI installation.\nIf you do not do this, then the passwords are created for you.\nThe password for Cassandra is already created during ASM install, so you will\nsee a warning when you perform the following.\nThe creation of the Cassandra secret is still included here for completeness.\nChange the ",Object(a.b)("inlineCode",{parentName:"p"},"noins")," to your namespace, and change the ",Object(a.b)("inlineCode",{parentName:"p"},"Netcool2020")," sample\npassword to your preferred password.  "),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{}),"oc create secret generic noirel1-icpadmin-secret --from-literal=ICP_ADMIN_PASSWORD=Netcool2020 --namespace noins\noc create secret generic noirel1-impact-secret --from-literal=IMPACT_ADMIN_PASSWORD=Netcool2020 --namespace noins\noc create secret generic noirel1-la-secret --from-literal=UNITY_ADMIN_PASSWORD=Netcool2020 --namespace noins\noc create secret generic noirel1-ldap-secret --from-literal=LDAP_BIND_PASSWORD=Netcool2020 --namespace noins\noc create secret generic noirel1-omni-secret --from-literal=OMNIBUS_ROOT_PASSWORD=Netcool2020 --namespace noins\noc create secret generic noirel1-was-secret --from-literal=WAS_PASSWORD=Netcool2020 --namespace noins\noc create secret generic noirel1-couchdb-secret --from-literal=password=Netcool2020 --from-literal=secret=couchdb --from-literal=username=root --namespace noins\noc create secret generic noirel1-systemauth-secret --from-literal=password=Netcool2020 --from-literal=username=system --namespace noins\noc create secret generic noirel1-ibm-hdm-common-ui-session-secret --from-literal=session=Netcool2020 --namespace noins\noc create secret generic noirel1-cassandra-auth-secret --from-literal=username=hdm --from-literal=password=Netcool2020 --namespace noins\noc create secret generic noirel1-ibm-redis-authsecret --from-literal=username=redis --from-literal=password=Netcool2020 --namespace noins\noc create secret generic noirel1-kafka-admin-secret --from-literal=username=kafka --from-literal=password=Netcool2020 --namespace noins\noc create secret generic noirel1-kafka-client-secret --from-literal=username=admin --from-literal=password=Netcool2020 --namespace noins\n")),Object(a.b)(c,{mdxType:"InlineNotification"},Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Note"),": At the time of this writing, the online manual mistakenly creates a\npassword for ",Object(a.b)("inlineCode",{parentName:"p"},"noirel1-impactadmin-secret")," rather than ",Object(a.b)("inlineCode",{parentName:"p"},"noirel1-impact-secret"),".\nThe name has been corrected in the above command.")),Object(a.b)("h3",null,"Deploying the NOI helm chart"),Object(a.b)("p",null,"Log in to the IBM Common Services GUI, select Catalog, type “netcool” in the\nsearch fields, and select the NOI Chart."),Object(a.b)("h4",null,"Specifying the configuration."),Object(a.b)("p",null,"The following are some notes on the configuration."),Object(a.b)("table",null,Object(a.b)("thead",{parentName:"table"},Object(a.b)("tr",{parentName:"thead"},Object(a.b)("th",r({parentName:"tr"},{align:null}),"Configuration"),Object(a.b)("th",r({parentName:"tr"},{align:null}),"Suggested Values"),Object(a.b)("th",r({parentName:"tr"},{align:null}),"Description"))),Object(a.b)("tbody",{parentName:"table"},Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",r({parentName:"tr"},{align:null}),"Helm release name"),Object(a.b)("td",r({parentName:"tr"},{align:null}),"noirel1"),Object(a.b)("td",r({parentName:"tr"},{align:null}),"Replace this with your NOI release name, it can not be the same with the ASM release name.")),Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",r({parentName:"tr"},{align:null}),"Target namespace"),Object(a.b)("td",r({parentName:"tr"},{align:null}),"noins"),Object(a.b)("td",r({parentName:"tr"},{align:null}),"The namespace where you did all the previous service account and password creation.  It should be the same as the ASM namespace.")),Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",r({parentName:"tr"},{align:null}),"Target Cluster"),Object(a.b)("td",r({parentName:"tr"},{align:null}),"local-cluster"),Object(a.b)("td",r({parentName:"tr"},{align:null}),"Unless you use MCM to deploy to a remote cluster.")),Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",r({parentName:"tr"},{align:null}),"Pod Security"),Object(a.b)("td",r({parentName:"tr"},{align:null}),"ibm-priviledged-psp"),Object(a.b)("td",r({parentName:"tr"},{align:null}),"You have configured this earlier.")),Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",r({parentName:"tr"},{align:null}),"Master Node"),Object(a.b)("td",r({parentName:"tr"},{align:null}),Object(a.b)("inlineCode",{parentName:"td"},"apps.<THE-OCP-CLUSTER-BASE-DOMAIN-NAME>")),Object(a.b)("td",r({parentName:"tr"},{align:null}),"The OCP service base name.")),Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",r({parentName:"tr"},{align:null}),"Https Port"),Object(a.b)("td",r({parentName:"tr"},{align:null}),"443"),Object(a.b)("td",r({parentName:"tr"},{align:null}),"The default 443 should be good unless you have a specific network config.")),Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",r({parentName:"tr"},{align:null}),"Image repository"),Object(a.b)("td",r({parentName:"tr"},{align:null}),Object(a.b)("inlineCode",{parentName:"td"},"image-registry.openshift-image-registry.svc:5000/noins")),Object(a.b)("td",r({parentName:"tr"},{align:null}),"Change this from the default external repository.  Change noins to your namespace.")),Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",r({parentName:"tr"},{align:null}),"Docker image repository secret"),Object(a.b)("td",r({parentName:"tr"},{align:null}),"Leave Blank"),Object(a.b)("td",r({parentName:"tr"},{align:null}),"Leave it blank unless you want to use a secret that you have created previously.")),Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",r({parentName:"tr"},{align:null}),"Environment Size"),Object(a.b)("td",r({parentName:"tr"},{align:null}),"Size1"),Object(a.b)("td",r({parentName:"tr"},{align:null}),"For POC change to Size0")),Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",r({parentName:"tr"},{align:null}),"ServiceAccount under which your pods run"),Object(a.b)("td",r({parentName:"tr"},{align:null}),"noi-service-account"),Object(a.b)("td",r({parentName:"tr"},{align:null}),"Pre-filled, you have created this earlier.")),Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",r({parentName:"tr"},{align:null}),"Create required RBAC RoleBinding"),Object(a.b)("td",r({parentName:"tr"},{align:null}),"check"),Object(a.b)("td",r({parentName:"tr"},{align:null}),"The default is not checked.")),Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",r({parentName:"tr"},{align:null}),"Use existing TLS certificate secrets"),Object(a.b)("td",r({parentName:"tr"},{align:null}),"check"),Object(a.b)("td",r({parentName:"tr"},{align:null}),"The default is not checked.")),Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",r({parentName:"tr"},{align:null}),"Indicate that all password secrets have been created prior to install"),Object(a.b)("td",r({parentName:"tr"},{align:null}),"check"),Object(a.b)("td",r({parentName:"tr"},{align:null}),"Unless you want the installer to generate the secrets.")),Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",r({parentName:"tr"},{align:null}),"Enable sub-chart resource requests"),Object(a.b)("td",r({parentName:"tr"},{align:null}),"check"),Object(a.b)("td",r({parentName:"tr"},{align:null}),"default. Enabling this will use more resources. You might want to uncheck this for POC.")),Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",r({parentName:"tr"},{align:null}),"Enable anti-affinity"),Object(a.b)("td",r({parentName:"tr"},{align:null}),"check"),Object(a.b)("td",r({parentName:"tr"},{align:null}),"default.  For resilience, always check this.")),Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",r({parentName:"tr"},{align:null}),"Enable data persistence"),Object(a.b)("td",r({parentName:"tr"},{align:null}),"check"),Object(a.b)("td",r({parentName:"tr"},{align:null}),"Unless you are doing a POC and do not want to persist the data.")),Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",r({parentName:"tr"},{align:null}),"Use dynamic provisioning"),Object(a.b)("td",r({parentName:"tr"},{align:null}),"check"),Object(a.b)("td",r({parentName:"tr"},{align:null}),"If you do not use the dynamic provisioning, then you need to create the PVC first.")),Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",r({parentName:"tr"},{align:null}),"Number of Impact server instance"),Object(a.b)("td",r({parentName:"tr"},{align:null}),"2"),Object(a.b)("td",r({parentName:"tr"},{align:null}),"(default is 1).")),Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",r({parentName:"tr"},{align:null}),"LDAP Mode"),Object(a.b)("td",r({parentName:"tr"},{align:null}),"standalone"),Object(a.b)("td",r({parentName:"tr"},{align:null}),Object(a.b)("strong",{parentName:"td"}," Note:")," If you specify standalone, ",Object(a.b)("strong",{parentName:"td"},"do not change")," any of the LDAP configurations after this.  Only specify the details of the LDAP for proxy.")),Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",r({parentName:"tr"},{align:null}),"Enable ASM Integration"),Object(a.b)("td",r({parentName:"tr"},{align:null}),"check"),Object(a.b)("td",r({parentName:"tr"},{align:null}),"Check, unless you want to install only NOI.")))),Object(a.b)("h4",null,"Monitoring the deployment."),Object(a.b)("p",null,"Watch for the pods. "),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{}),"watch -n15 oc get pods -n noins\n")),Object(a.b)("p",null,"Once the pods are all up, then you have completed the installation."),Object(a.b)("h3",null,Object(a.b)("strong",{parentName:"h3"},"A Few Common Issues")),Object(a.b)("p",null,"Some common issues during the deployment include:"),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},Object(a.b)("strong",{parentName:"li"},"Not enough compute (CPU, Memory) resources"),".  The impact pods (",Object(a.b)("inlineCode",{parentName:"li"},"*-nciserver-*"),") are initialized last.\nIt also requires a comparatively larger compute resource. If your impact\npods are not running, then run the ",Object(a.b)("inlineCode",{parentName:"li"},"oc describe pods <POD_NAME>")," command to check what caused it."),Object(a.b)("li",{parentName:"ul"},Object(a.b)("strong",{parentName:"li"},"Not enough storage"),".  If you do not have enough Disk Storage, then the\nPVCs might not all be successfully created.  You should be able to see this\nalso using the ",Object(a.b)("inlineCode",{parentName:"li"},"oc describe pods <POD_NAME>")," command.")),Object(a.b)("p",null,"More information on installing Netcool Operation Insight can be found in the ",Object(a.b)("a",r({parentName:"p"},{href:"https://www.ibm.com/support/knowledgecenter/SSTPTP_1.6.0/com.ibm.netcool_ops.doc/soc/integration/task/int_installing-opsmg-rhocp_ui.html"}),"IBM Knowledge Center"),"."),Object(a.b)("a",{name:"nom-post"}),Object(a.b)("h2",null,"Post-installation steps"),Object(a.b)("p",null,"If you install Agile Service Manager after Netcool Operation Insight, you must restart some services. If the Agile Service Manager secrets are changed, you must also restart some services.  This is described in ",Object(a.b)("a",r({parentName:"p"},{href:"https://www.ibm.com/support/knowledgecenter/SSTPTP_1.6.0/com.ibm.netcool_ops.doc/soc/integration/task/int_installing-asm-rhocp.html"}),"the IBM Knowledge Center")),Object(a.b)("h3",null,"Helm release details"),Object(a.b)("p",null,"Get the helm details of the ASM release."),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{}),"helm status asmrel1 --tls\n")),Object(a.b)("p",null,"From the output, you can see useful information about the resources created\nby the Helm install as well as some useful commands."),Object(a.b)("p",null,"Similarly, you can check the helm status of the NOI Release."),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{}),"helm status noirel1 --tls\n")),Object(a.b)("p",null,"The following lists some of the information provided by the above helm status\ncommands."),Object(a.b)("table",null,Object(a.b)("thead",{parentName:"table"},Object(a.b)("tr",{parentName:"thead"},Object(a.b)("th",r({parentName:"tr"},{align:null}),"Component"),Object(a.b)("th",r({parentName:"tr"},{align:null}),"URL"))),Object(a.b)("tbody",{parentName:"table"},Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",r({parentName:"tr"},{align:null}),"WebGUI"),Object(a.b)("td",r({parentName:"tr"},{align:null}),Object(a.b)("inlineCode",{parentName:"td"},"https://netcool.noirel1.apps.<OCP_CLUSTER>:443/ibm/console"))),Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",r({parentName:"tr"},{align:null}),"WAS"),Object(a.b)("td",r({parentName:"tr"},{align:null}),Object(a.b)("inlineCode",{parentName:"td"},"https://was.noirel1.apps.<OCP_CLUSTER>:443/ibm/console"))),Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",r({parentName:"tr"},{align:null}),"Log Analytics"),Object(a.b)("td",r({parentName:"tr"},{align:null}),Object(a.b)("inlineCode",{parentName:"td"},"https://scala.noirel1.apps.<OCP_CLUSTER>:443/Unity"))),Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",r({parentName:"tr"},{align:null}),"Impact"),Object(a.b)("td",r({parentName:"tr"},{align:null}),Object(a.b)("inlineCode",{parentName:"td"},"https://impact.noirel1.apps.<OCP_CLUSTER>:443/ibm/console"))))),Object(a.b)("h3",null,"Assigning roles"),Object(a.b)("p",null,"Log in to DASH and assign the user or group roles.\nYour ASM and NOI base system is now installed and ready."),Object(a.b)("p",null,"More information on administering users can be found in the ",Object(a.b)("a",r({parentName:"p"},{href:"https://www.ibm.com/support/knowledgecenter/SSTPTP_1.6.0/com.ibm.netcool_ops.doc/soc/admin/task/adm_administering-users.html"}),"IBM Knowledge Center")),Object(a.b)("p",null,Object(a.b)("a",r({parentName:"p"},{href:"/mcm/cp4mcm_netcool_ops_manager"}),"Back to NOI current version - 1.6.1")))}p.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-mcm-cp-4-mcm-netcool-ops-manager-noi-1603-index-mdx-2ed42e0a50113de59c94.js.map