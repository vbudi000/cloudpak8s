{"version":3,"sources":["webpack:///./node_modules/gatsby-theme-carbon/src/components/PageHeader/index.js","webpack:///./node_modules/gatsby-theme-carbon/src/components/PageHeader/PageHeader.js","webpack:///./node_modules/gatsby-theme-carbon/src/components/EditLink/index.js","webpack:///./node_modules/gatsby-theme-carbon/src/components/EditLink/EditLink.js","webpack:///./node_modules/gatsby-theme-carbon/src/components/PageTabs/index.js","webpack:///./node_modules/gatsby-theme-carbon/src/components/PageTabs/PageTabs.js","webpack:///./node_modules/gatsby-theme-carbon/src/templates/Default.js","webpack:///./src/pages/day2/Backups/index.mdx"],"names":["PageHeader","title","tabs","className","cx","pageHeader","withTabs","length","id","text","EditLink","relativePagePath","repositoryProp","repository","site","siteMetadata","baseUrl","subDirectory","href","branch","row","link","PageTabs","render","this","props","slug","currentTab","split","filter","Boolean","slice","pageTabs","map","tab","slugifiedTab","slugify","lower","selected","currentTabRegex","RegExp","replace","key","selectedItem","listItem","to","tabsContainer","list","React","Component","Default","pageContext","children","location","Title","frontmatter","titleType","theme","description","keywords","pathPrefix","pathname","Layout","homepage","pageTitle","pageDescription","pageKeywords","label","Main","padded","NextPrevious","BackToTopBtn","_frontmatter","layoutProps","MDXLayout","DefaultLayout","MDXContent","components","mdxType","parentName","name","isMDXComponent"],"mappings":"iPAEeA,ECGI,SAAC,GAAD,MAAGC,EAAH,EAAGA,MAAH,IAAUC,YAAV,MAAiB,GAAjB,SACjB,mBAAKC,UAAWC,IAAGC,cAAD,OAAgBC,YAAWJ,EAAKK,OAAhC,KAChB,mBAAKJ,UAAU,YACb,mBAAKA,UAAU,WACb,mBAAKA,UAAU,iBACb,kBAAIK,GAAG,aAAaL,UAAWM,QAC5BR,Q,wBCTES,ECIE,SAAC,GAAsD,IAApDC,EAAmD,EAAnDA,iBAA8BC,EAAqB,EAAjCC,WAGhBA,EAHiD,OAEnEC,KACEC,aAAgBF,WAHiD,EAmB3BD,GAAkBC,EAApDG,EAnB6D,EAmB7DA,QAASC,EAnBoD,EAmBpDA,aAEXC,EAAUF,EAAN,SArB2D,EAmBtCG,OAEUF,EAA/B,aAAwDN,EAElE,OAAOK,EACL,mBAAKb,UAAS,WAAaiB,OACzB,mBAAKjB,UAAU,WACb,iBAAGA,UAAWkB,OAAMH,KAAMA,GAA1B,8BAKF,M,oDCnCSI,E,gLCkBbC,OAAA,WAAU,IAAD,EACgBC,KAAKC,MAApBvB,EADD,EACCA,KAAMwB,EADP,EACOA,KACRC,EAAaD,EAChBE,MAAM,KACNC,OAAOC,SACPC,OAAO,GAAG,GAEPC,EAAW9B,EAAK+B,KAAI,SAAAC,GAAQ,IAAD,EACzBC,EAAeC,IAAQF,EAAK,CAAEG,OAAO,IACrCC,EAAWH,IAAiBR,EAC5BY,EAAkB,IAAIC,OAAUb,EAAd,SAClBT,EAAOQ,EAAKe,QAAQF,EAAiBJ,GAC3C,OACE,kBAAIO,IAAKR,EAAK/B,UAAWC,KAAE,OAAIuC,gBAAeL,EAAnB,GAA+BM,aACxD,YAAC,OAAD,CAAMzC,UAAWkB,OAAMwB,GAAE,GAAK3B,GAC3BgB,OAMT,OACE,mBAAK/B,UAAW2C,iBACd,mBAAK3C,UAAU,YACb,mBAAKA,UAAU,WACb,mBAAKA,UAAU,mCACb,uBACE,kBAAIA,UAAW4C,QAAOf,S,GAjCAgB,IAAMC,W,YCyD7BC,IA3DC,SAAC,GAAgD,IAA9CC,EAA6C,EAA7CA,YAAaC,EAAgC,EAAhCA,SAAUC,EAAsB,EAAtBA,SAAUC,EAAY,EAAZA,MAAY,EACJH,EAAlDI,mBADsD,MACxC,GADwC,EACpC5C,EAAgCwC,EAAhCxC,iBAAkB6C,EAAcL,EAAdK,UACpCtD,EAA8CqD,EAA9CrD,KAAMD,EAAwCsD,EAAxCtD,MAAOwD,EAAiCF,EAAjCE,MAAOC,EAA0BH,EAA1BG,YAAaC,EAAaJ,EAAbI,SAI/BC,EANoD,OAM5D9C,KAAQ8C,WAUJlC,EAAOkC,EACTP,EAASQ,SAASpB,QAAQmB,EAAY,IACtCP,EAASQ,SAYPlC,EATCzB,EAEHwB,EACGE,MAAM,KACNC,OAAOC,SACPC,OAAO,GAAG,IAAMK,IAAQlC,EAAK,GAAI,CAAEmC,OAAO,IAL7B,GAUpB,OACE,YAACyB,EAAA,EAAD,CACE5D,KAAMA,EACN6D,UAAU,EACVN,MAAOA,EACPO,UAAW/D,EACXgE,gBAAiBP,EACjBQ,aAAcP,EACdH,UAAWA,GAEX,YAAC,EAAD,CAAYvD,MAAOqD,EAAQ,YAACA,EAAD,MAAYrD,EAAOkE,MAAM,QAAQjE,KAAMA,IACjEA,GAAQ,YAAC,EAAD,CAAUwB,KAAMA,EAAMxB,KAAMA,EAAMyB,WAAYA,IACvD,YAACyC,EAAA,EAAD,CAAMC,QAAM,GACTjB,EACD,YAAC,EAAD,CAAUzC,iBAAkBA,KAE9B,YAAC2D,EAAA,EAAD,CACEnB,YAAaA,EACbE,SAAUA,EACV3B,KAAMA,EACNxB,KAAMA,EACNyB,WAAYA,IAEd,YAAC4C,EAAA,EAAD,S,isBC5DC,IAAMC,EAAe,GAOtBC,EAAc,CAClBD,gBAEIE,EAAYC,IACH,SAASC,EAAT,GAGZ,IAFDC,EAEC,EAFDA,WACGpD,E,oIACF,mBACD,OAAO,YAACiD,EAAD,KAAeD,EAAiBhD,EAAhC,CAAuCoD,WAAYA,EAAYC,QAAQ,cAG5E,0CACA,oVAEA,8ZACA,4DAA2C,kBAAIC,WAAW,MAA1D,KACF,mBAAGA,WAAW,KAAQ,CAChB,KAAQ,2FADd,0FADE,MAIA,mfACA,uJACA,sGAAqF,sBAAQA,WAAW,KAAnB,iBAArF,QAA+I,sBAAQA,WAAW,KAAnB,2BAA/I,QACA,sBACE,kBAAIA,WAAW,MAAf,mDACA,kBAAIA,WAAW,MAAf,mHAEF,wuBACA,wHACA,mGAAkF,mBAAGA,WAAW,KAAQ,CACpG,KAAQ,0BADsE,aAAlF,uOAGA,wCACA,odACA,sBACE,kBAAIA,WAAW,MAAf,uNAEF,wCACA,2JACA,sBACE,kBAAIA,WAAW,MAAK,mBAAGA,WAAW,MAAS,CACvC,KAAQ,0BADQ,8BAApB,qGAGA,kBAAIA,WAAW,MAAK,mBAAGA,WAAW,MAAS,CACvC,KAAQ,wBADQ,kBAApB,2LAGA,kBAAIA,WAAW,MAAK,mBAAGA,WAAW,MAAS,CACvC,KAAQ,uBADQ,iBAApB,4HAEuJ,mBAAGA,WAAW,MAAS,CAC1K,KAAQ,cAD2I,YAFvJ,KAKA,kBAAIA,WAAW,MAAK,mBAAGA,WAAW,MAAS,CACvC,KAAQ,4BADQ,sBAApB,kHAEkJ,mBAAGA,WAAW,MAAS,CACrK,KAAQ,gBADsI,YAFlJ,KAKA,kBAAIA,WAAW,MAAK,mBAAGA,WAAW,MAAS,CACvC,KAAQ,8BADQ,4BAApB,iIAGA,kBAAIA,WAAW,MAAK,mBAAGA,WAAW,MAAS,CACvC,KAAQ,sBADQ,oBAApB,6NAGA,kBAAIA,WAAW,MAAK,mBAAGA,WAAW,MAAS,CACvC,KAAQ,+BADQ,6BAApB,yGAGA,kBAAIA,WAAW,MAAK,mBAAGA,WAAW,MAAS,CACvC,KAAQ,uCADQ,uCAApB,0EAGA,kBAAIA,WAAW,MAAK,mBAAGA,WAAW,MAAS,CACvC,KAAQ,2CADQ,yBAApB,gJAGA,kBAAIA,WAAW,MAAK,mBAAGA,WAAW,MAAS,CACvC,KAAQ,wDADQ,sDAApB,qJAGA,kBAAIA,WAAW,MAAK,mBAAGA,WAAW,MAAS,CACvC,KAAQ,iCADQ,+BAApB,iKAIF,2CACA,6FACA,sBACE,kBAAIA,WAAW,MAAf,+LAAoN,kBAAIA,WAAW,MAC/N,kBAAIA,WAAW,MAAf,qCACA,kBAAIA,WAAW,MAAf,kEAEJ,kBAAIA,WAAW,MAAf,wEACA,kBAAIA,WAAW,MAAf,uTAEF,2CACA,qGACA,sBACE,kBAAIA,WAAW,MAAK,mBAAGA,WAAW,MAAS,CACvC,KAAQ,+BADQ,6BAApB,seAGA,kBAAIA,WAAW,MAAK,mBAAGA,WAAW,MAAS,CACvC,KAAQ,sCADQ,oCAApB,gKAGA,kBAAIA,WAAW,MAAK,mBAAGA,WAAW,MAAS,CACvC,KAAQ,yCADQ,uCAApB,8RAIF,6CACA,yBACE,qBAAOA,WAAW,SAChB,kBAAIA,WAAW,SACb,oBAAIA,WAAW,MAAS,CACtB,MAAS,OADX,MAGA,oBAAIA,WAAW,MAAS,CACtB,MAAS,OADX,WAGA,oBAAIA,WAAW,MAAS,CACtB,MAAS,OADX,UAKJ,qBAAOA,WAAW,SAChB,kBAAIA,WAAW,SACb,oBAAIA,WAAW,MAAS,CACtB,MAAS,OADX,KAGA,oBAAIA,WAAW,MAAS,CACtB,MAAS,OADX,OAGA,oBAAIA,WAAW,MAAS,CACtB,MAAS,OADX,yBAIF,kBAAIA,WAAW,SACb,oBAAIA,WAAW,MAAS,CACtB,MAAS,OADX,KAGA,oBAAIA,WAAW,MAAS,CACtB,MAAS,OADX,OAGA,oBAAIA,WAAW,MAAS,CACtB,MAAS,OADX,uBAIF,kBAAIA,WAAW,SACb,oBAAIA,WAAW,MAAS,CACtB,MAAS,OADX,KAGA,oBAAIA,WAAW,MAAS,CACtB,MAAS,OADX,OAGA,oBAAIA,WAAW,MAAS,CACtB,MAAS,OADX,sBAIF,kBAAIA,WAAW,SACb,oBAAIA,WAAW,MAAS,CACtB,MAAS,OADX,KAGA,oBAAIA,WAAW,MAAS,CACtB,MAAS,OADX,OAGA,oBAAIA,WAAW,MAAS,CACtB,MAAS,OADX,4BAIF,kBAAIA,WAAW,SACb,oBAAIA,WAAW,MAAS,CACtB,MAAS,OADX,KAGA,oBAAIA,WAAW,MAAS,CACtB,MAAS,OADX,OAGA,oBAAIA,WAAW,MAAS,CACtB,MAAS,OADX,6BAIF,kBAAIA,WAAW,SACb,oBAAIA,WAAW,MAAS,CACtB,MAAS,OADX,KAGA,oBAAIA,WAAW,MAAS,CACtB,MAAS,OADX,OAGA,oBAAIA,WAAW,MAAS,CACtB,MAAS,OADX,qBAIF,kBAAIA,WAAW,SACb,oBAAIA,WAAW,MAAS,CACtB,MAAS,OADX,KAGA,oBAAIA,WAAW,MAAS,CACtB,MAAS,OADX,OAGA,oBAAIA,WAAW,MAAS,CACtB,MAAS,OADX,8BAIF,kBAAIA,WAAW,SACb,oBAAIA,WAAW,MAAS,CACtB,MAAS,OADX,KAGA,oBAAIA,WAAW,MAAS,CACtB,MAAS,OADX,OAGA,oBAAIA,WAAW,MAAS,CACtB,MAAS,OADX,wCAIF,kBAAIA,WAAW,SACb,oBAAIA,WAAW,MAAS,CACtB,MAAS,OADX,KAGA,oBAAIA,WAAW,MAAS,CACtB,MAAS,OADX,OAGA,oBAAIA,WAAW,MAAS,CACtB,MAAS,OADX,0CAIF,kBAAIA,WAAW,SACb,oBAAIA,WAAW,MAAS,CACtB,MAAS,OADX,MAGA,oBAAIA,WAAW,MAAS,CACtB,MAAS,OADX,OAGA,oBAAIA,WAAW,MAAS,CACtB,MAAS,OADX,uDAIF,kBAAIA,WAAW,SACb,oBAAIA,WAAW,MAAS,CACtB,MAAS,OADX,MAGA,oBAAIA,WAAW,MAAS,CACtB,MAAS,OADX,wBAGA,oBAAIA,WAAW,MAAS,CACtB,MAAS,OADX,gCAIF,kBAAIA,WAAW,SACb,oBAAIA,WAAW,MAAS,CACtB,MAAS,OADX,MAGA,oBAAIA,WAAW,MAAS,CACtB,MAAS,OADX,wBAGA,oBAAIA,WAAW,MAAS,CACtB,MAAS,OADX,8BAIF,kBAAIA,WAAW,SACb,oBAAIA,WAAW,MAAS,CACtB,MAAS,OADX,MAGA,oBAAIA,WAAW,MAAS,CACtB,MAAS,OADX,wBAGA,oBAAIA,WAAW,MAAS,CACtB,MAAS,OADX,qCAIF,kBAAIA,WAAW,SACb,oBAAIA,WAAW,MAAS,CACtB,MAAS,OADX,MAGA,oBAAIA,WAAW,MAAS,CACtB,MAAS,OADX,wBAGA,oBAAIA,WAAW,MAAS,CACtB,MAAS,OADX,0CAMN,iBAAGC,KAAK,yBACR,0DACA,2IAA0H,kBAAID,WAAW,MAAzI,kJAEA,kNACA,4HAA2G,kBAAIA,WAAW,MAA1H,qHAC+G,kBAAIA,WAAW,MAD9H,iKAGA,qGAAoF,kBAAIA,WAAW,MAAnG,KACF,mBAAGA,WAAW,KAAQ,CAChB,KAAQ,8FADd,6FADE,MAIA,iBAAGC,KAAK,uBACR,wDACA,y1BACA,iBAAGA,KAAK,sBACR,mDACA,+IAA8H,mBAAGD,WAAW,KAAQ,CAChJ,KAAQ,cADkH,YAA9H,OAGA,4VACA,sBACE,kBAAIA,WAAW,MAAf,mFACA,kBAAIA,WAAW,MAAf,wHACA,kBAAIA,WAAW,MAAf,kIACA,kBAAIA,WAAW,MAAf,WAEF,oQACA,iBAAGC,KAAK,2BACR,wDACA,qIAAoH,mBAAGD,WAAW,KAAQ,CACtI,KAAQ,iBADwG,YAApH,OAGA,iBAAGC,KAAK,6BACR,8DACA,qJACA,sBACE,kBAAID,WAAW,MAAK,sBAAQA,WAAW,MAAnB,cAApB,kCACA,kBAAIA,WAAW,MAAK,sBAAQA,WAAW,MAAnB,WAApB,oBACA,kBAAIA,WAAW,MAAK,sBAAQA,WAAW,MAAnB,YAApB,sBACA,kBAAIA,WAAW,MAAK,sBAAQA,WAAW,MAAnB,gBAApB,wBAEF,iBAAGC,KAAK,qBACR,sDACA,kPACA,iBAAGA,KAAK,8BACR,2EACA,4MACA,sIAAqH,kBAAID,WAAW,MAApI,2LAEA,uRACA,4DAA2C,kBAAIA,WAAW,MAA1D,KACF,mBAAGA,WAAW,KAAQ,CAChB,KAAQ,2FADd,0FADE,OAIA,2XACA,sBACE,kBAAIA,WAAW,MAAf,oEACA,kBAAIA,WAAW,MAAf,qIACA,kBAAIA,WAAW,MAAf,WAEF,gRACA,iBAAGC,KAAK,sCACR,uEACA,8LACA,4BAAW,sBAAQD,WAAW,KAAnB,QAAX,gNAAoQ,kBAAIA,WAAW,MAAnR,4HACsH,kBAAIA,WAAW,MADrI,kOAE4N,kBAAIA,WAAW,MAF3O,KAGF,mBAAGA,WAAW,KAAQ,CAChB,KAAQ,mFADd,kFAHE,OAMA,qEACA,sBACE,kBAAIA,WAAW,MAAf,iGACA,kBAAIA,WAAW,MAAf,uJACA,kBAAIA,WAAW,MAAf,qKAEF,qNAAoM,kBAAIA,WAAW,MAAnN,gFAEA,kHAAiG,kBAAIA,WAAW,MAAhH,KACF,mBAAGA,WAAW,KAAQ,CAChB,KAAQ,sGADd,qGADE,KAIF,mBAAGA,WAAW,KAAQ,CAChB,KAAQ,qJADd,oJAJE,MAOA,iBAAGC,KAAK,0CACR,2EACA,wIAAuH,kBAAID,WAAW,MAAtI,uGAEA,qNACA,uHAAsG,kBAAIA,WAAW,MAArH,KACF,mBAAGA,WAAW,KAAQ,CAChB,KAAQ,mIADd,mIAGE,iBAAGC,KAAK,uDACR,wFACA,icAEA,mIAAkH,kBAAID,WAAW,MAAjI,KACF,mBAAGA,WAAW,KAAQ,CAChB,KAAQ,qJADd,oJADE,OAIA,iBAAGC,KAAK,gCACR,mFACA,oWACA,waACA,sSACA,4DAA2C,kBAAID,WAAW,MAA1D,KACF,mBAAGA,WAAW,KAAQ,CAChB,KAAQ,2FADd,0FADE,MAIA,iBAAGC,KAAK,qCACR,wFACA,oKAAmJ,kBAAID,WAAW,MAAlK,4LACsL,kBAAIA,WAAW,MADrM,sEAEgE,mBAAGA,WAAW,KAAQ,CAClF,KAAQ,oEADoD,sBAFhE,oRAIoT,mBAAGA,WAAW,KAAQ,CACtU,KAAQ,iKADwS,gBAJpT,oaAOA,gEAA+C,kBAAIA,WAAW,MAA9D,KACF,mBAAGA,WAAW,KAAQ,CAChB,KAAQ,uCADd,uCAGE,qDACA,oJAAmI,0BAAYA,WAAW,KAAvB,WAAnI,sBAA6M,0BAAYA,WAAW,KAAvB,aAA7M,iBACA,iBAAGC,KAAK,wCACR,2FACA,gTACA,iyBAEA,6CACA,mDACA,kJAAiI,kBAAID,WAAW,MAAhJ,iGAEA,kDACA,uEAAsD,kBAAIA,WAAW,MAArE,KACF,mBAAGA,WAAW,KAAQ,CAChB,KAAQ,8FADd,6FADE,MAIA,iIACA,+CACA,wDACA,6eACA,gCACA,qBAAG,sBAAQA,WAAW,KAAnB,UAA0C,kBAAIA,WAAW,MAA5D,+JACyJ,kBAAIA,WAAW,MADxK,KAEF,mBAAGA,WAAW,KAAQ,CAChB,KAAQ,uBADd,sBAEiC,kBAAIA,WAAW,MAJ9C,0BAKoB,mBAAGA,WAAW,KAAQ,CACtC,KAAQ,oDADQ,mDALpB,MAQA,qBAAG,sBAAQA,WAAW,KAAnB,SAAH,KACF,mBAAGA,WAAW,KAAQ,CAChB,KAAQ,uBADd,SADE,MAIA,6CACA,sBACE,kBAAIA,WAAW,MAAf,ijBAEF,sBACE,kBAAIA,WAAW,MAAf,yeAMNH,EAAWK,gBAAiB","file":"component---src-pages-day-2-backups-index-mdx-fcd113f16285c535ab6e.js","sourcesContent":["import PageHeader from './PageHeader';\n\nexport default PageHeader;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport cx from 'classnames';\nimport { pageHeader, withTabs, text } from './PageHeader.module.scss';\n\nconst PageHeader = ({ title, tabs = [] }) => (\n  <div className={cx(pageHeader, { [withTabs]: tabs.length })}>\n    <div className=\"bx--grid\">\n      <div className=\"bx--row\">\n        <div className=\"bx--col-lg-12\">\n          <h1 id=\"page-title\" className={text}>\n            {title}\n          </h1>\n        </div>\n      </div>\n    </div>\n  </div>\n);\n\nPageHeader.propTypes = {\n  /**\n   * Specify the title for the page\n   */\n  title: PropTypes.node,\n};\n\nexport default PageHeader;\n","import EditLink from './EditLink';\n\nexport default EditLink;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { graphql, useStaticQuery } from 'gatsby';\n\nimport { link, row } from './EditLink.module.scss';\n\nconst EditLink = ({ relativePagePath, repository: repositoryProp }) => {\n  const {\n    site: {\n      siteMetadata: { repository },\n    },\n  } = useStaticQuery(graphql`\n    query REPOSITORY_QUERY {\n      site {\n        siteMetadata {\n          repository {\n            baseUrl\n            subDirectory\n            branch\n          }\n        }\n      }\n    }\n  `);\n\n  const { baseUrl, subDirectory, branch } = repositoryProp || repository;\n\n  const href = `${baseUrl}/edit/${branch}${subDirectory}/src/pages${relativePagePath}`;\n\n  return baseUrl ? (\n    <div className={`bx--row ${row}`}>\n      <div className=\"bx--col\">\n        <a className={link} href={href}>\n          Edit this page on GitHub\n        </a>\n      </div>\n    </div>\n  ) : null;\n};\n\nEditLink.propTypes = {\n  repository: PropTypes.shape({\n    baseUrl: PropTypes.string,\n    subDirectory: PropTypes.string,\n    branch: PropTypes.string,\n  }),\n  relativePagePath: PropTypes.string,\n};\n\nexport default EditLink;\n","import PageTabs from './PageTabs';\n\nexport default PageTabs;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Link } from 'gatsby';\nimport slugify from 'slugify';\nimport cx from 'classnames';\n\nimport {\n  tabsContainer,\n  list,\n  selectedItem,\n  listItem,\n  link,\n} from './PageTabs.module.scss';\n\nexport default class PageTabs extends React.Component {\n  static propTypes = {\n    tabs: PropTypes.array,\n    slug: PropTypes.string,\n  };\n\n  render() {\n    const { tabs, slug } = this.props;\n    const currentTab = slug\n      .split('/')\n      .filter(Boolean)\n      .slice(-1)[0];\n\n    const pageTabs = tabs.map(tab => {\n      const slugifiedTab = slugify(tab, { lower: true });\n      const selected = slugifiedTab === currentTab;\n      const currentTabRegex = new RegExp(`${currentTab}(?!-)`);\n      const href = slug.replace(currentTabRegex, slugifiedTab);\n      return (\n        <li key={tab} className={cx({ [selectedItem]: selected }, listItem)}>\n          <Link className={link} to={`${href}`}>\n            {tab}\n          </Link>\n        </li>\n      );\n    });\n\n    return (\n      <div className={tabsContainer}>\n        <div className=\"bx--grid\">\n          <div className=\"bx--row\">\n            <div className=\"bx--col-lg-12 bx--col-no-gutter\">\n              <nav>\n                <ul className={list}>{pageTabs}</ul>\n              </nav>\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n","import React from 'react';\nimport slugify from 'slugify';\nimport { useStaticQuery, graphql } from 'gatsby';\n\nimport BackToTopBtn from '../components/BackToTopBtn';\nimport Layout from '../components/Layout';\nimport PageHeader from '../components/PageHeader';\nimport EditLink from '../components/EditLink';\nimport NextPrevious from '../components/NextPrevious';\nimport PageTabs from '../components/PageTabs';\nimport Main from '../components/Main';\n\nconst Default = ({ pageContext, children, location, Title }) => {\n  const { frontmatter = {}, relativePagePath, titleType } = pageContext;\n  const { tabs, title, theme, description, keywords } = frontmatter;\n\n  // get the path prefix if it exists\n  const {\n    site: { pathPrefix },\n  } = useStaticQuery(graphql`\n    query PATH_PREFIX_QUERY {\n      site {\n        pathPrefix\n      }\n    }\n  `);\n\n  // let gatsby handle prefixing\n  const slug = pathPrefix\n    ? location.pathname.replace(pathPrefix, '')\n    : location.pathname;\n\n  const getCurrentTab = () => {\n    if (!tabs) return '';\n    return (\n      slug\n        .split('/')\n        .filter(Boolean)\n        .slice(-1)[0] || slugify(tabs[0], { lower: true })\n    );\n  };\n\n  const currentTab = getCurrentTab();\n  return (\n    <Layout\n      tabs={tabs}\n      homepage={false}\n      theme={theme}\n      pageTitle={title}\n      pageDescription={description}\n      pageKeywords={keywords}\n      titleType={titleType}\n    >\n      <PageHeader title={Title ? <Title /> : title} label=\"label\" tabs={tabs} />\n      {tabs && <PageTabs slug={slug} tabs={tabs} currentTab={currentTab} />}\n      <Main padded>\n        {children}\n        <EditLink relativePagePath={relativePagePath} />\n      </Main>\n      <NextPrevious\n        pageContext={pageContext}\n        location={location}\n        slug={slug}\n        tabs={tabs}\n        currentTab={currentTab}\n      />\n      <BackToTopBtn />\n    </Layout>\n  );\n};\n\nexport default Default;\n","import React from 'react'\n  /* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsx mdx */\n\nimport DefaultLayout from \"/home/travis/build/ibm-cloud-architecture/cloudpak8s/node_modules/gatsby-theme-carbon/src/templates/Default.js\";\nexport const _frontmatter = {};\n\nconst makeShortcode = name => function MDXDefaultShortcode(props) {\n  console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n  return <div {...props} />;\n};\n\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = DefaultLayout;\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n\n    <h2>{`Backups Overview`}</h2>\n    <p>{`All Kubernetes resources are described by data stored in a reliable database which is etcd. In the event of some Pods being  deleted, their supervising Deployment will re-create them from the spec held in the etcd database. In case of your worker node failure, then it will be recovered.\nSo, do we need a backup?  `}</p>\n    <p>{`Here are a couple of examples. It will not prevent a misconfigured application from overwriting its data, or an operator from running a command with the wrong environment variables and accidentally dropping the production database instead of the development one. Another example is that it won’t protect you from accidentally deleting the storage volume by mis-clicking in a web console.  `}</p>\n    <p>{`Cloud Native DevOps with Kubernetes:`}<br parentName=\"p\"></br>{`\n`}<a parentName=\"p\" {...{\n        \"href\": \"https://learning.oreilly.com/library/view/cloud-native-devops/9781492040750/ch11.html#\"\n      }}>{`https://learning.oreilly.com/library/view/cloud-native-devops/9781492040750/ch11.html#`}</a>{`  `}</p>\n    <p>{`However, the major factor in running and managing a successful backup process is to understand the needs, SLOs and how services will be delivered to the platform users (i.e. the Platform Operators configure application backups, or the tools are provided and the Application teams configure backups and the platform team is only concerned with the Platform and Storage backups).  This split in responsibility is common and one of the major tenants of OpenShift - Self Service`}</p>\n    <p>{`As discussed below, you will find sections on “Day 1” (the installation) and “Day 2” (the daily operations) of the platform.  `}</p>\n    <p>{`When you consider backup in OCP there are 2 important catagories to consider: `}<strong parentName=\"p\">{`system backup`}</strong>{` and `}<strong parentName=\"p\">{`application data backup`}</strong>{`.   `}</p>\n    <ul>\n      <li parentName=\"ul\">{`System backup means backup up your etcd data.  `}</li>\n      <li parentName=\"ul\">{`Backup of Application Data includes both your deployments and data which your applications are accessing to.  `}</li>\n    </ul>\n    <p>{`However, one additional aspect that needs to taken into account is “What is contained within the platform??“.  While we discuss within this document the use of the out-of-the-box registry for storing images, capturing build or configuration data, there are cases where this data is not hosted within the platform.  As an example, an external build tool and image repository (i.e. GitOps), where all data for the application is stored in Git and webhooks are used to orchestrate build, tests and deployments.  In those cases the Platform SRE and the DevOps Engineer would focus on how and what must be backed up from a platform perspective and what is handled via a different group/domain (i.e. the SRE team for GitHub).`}</p>\n    <p>{`As in any backup it is very important that you test your ability to restore on a regular basis.`}</p>\n    <p>{`If you are using OpenShift “Managed” service from the Cloud vendor such as `}<a parentName=\"p\" {...{\n        \"href\": \"#Backups-on-IBM-Cloud\"\n      }}>{`IBM Cloud`}</a>{`, AWS, and Azure, your cloud provider may take care of the etcd and you may not be able to maintain the etcd yourself.  You need to check with your cloud provider to make sure whether you need to take care of the etcd or not.  `}</p>\n    <h2>{`Day 1 Platform`}</h2>\n    <p>{`As part of the platform installation, design decisions (Day 0), must be implemented or placed into the technical debt to be configured as part of Day 2.  As a starting point, the following Day 1 functionality/debt should be installed or captured as a set of initial tasks for Day 2.  While the common statement of “Backup all Persistent Volumes and you’re done”, would be nice, true platform and application backups require additional thought.`}</p>\n    <ul>\n      <li parentName=\"ul\">{`Selection and install of backup solutions for the platform.  This includes products, agents or agreed upon processes (i.e. if installed on VMware, how the backup functions of VMware will support the platform)  `}</li>\n    </ul>\n    <h2>{`Day 2 Platform`}</h2>\n    <p>{`Here are the list of Infrastructure-related backup items for day 2.  We will discuss each items in the later section on this page.`}</p>\n    <ul>\n      <li parentName=\"ul\"><a parentName=\"li\" {...{\n          \"href\": \"#Backing-up-etcd-data\"\n        }}>{`Backup etcd (master hosts)`}</a>{`: The etcd persists the state of all resource objects and you make a back up etcd data regularly.`}</li>\n      <li parentName=\"ul\"><a parentName=\"li\" {...{\n          \"href\": \"#Backing-up-storage\"\n        }}>{`Storage backup`}</a>{`: Stateful apps save data, mostly attached on storage (persistent volumes), and it contains all the information that apps need in order to run properly making it a priority to backup.`}</li>\n      <li parentName=\"ul\"><a parentName=\"li\" {...{\n          \"href\": \"#Backing-up-images\"\n        }}>{`Images backup`}</a>{`: You can use either internal or external Image Registry to store your images. We discuss the image backup in a separate `}<a parentName=\"li\" {...{\n          \"href\": \"../Image/\"\n        }}>{`document`}</a>{`.`}</li>\n      <li parentName=\"ul\"><a parentName=\"li\" {...{\n          \"href\": \"#Backing-up-certificate\"\n        }}>{`Certificate backup`}</a>{`: You have several TLS certificates in your OpenShift cluster. We discuss the certificate backup in a separate `}<a parentName=\"li\" {...{\n          \"href\": \"../Security\"\n        }}>{`document`}</a>{`.`}</li>\n      <li parentName=\"ul\"><a parentName=\"li\" {...{\n          \"href\": \"#backing-up-services-data\"\n        }}>{`Backing up services data`}</a>{`: In case you are using the advanced features which comes with OpenShift, you need to consider the persistent storage backup.`}</li>\n      <li parentName=\"ul\"><a parentName=\"li\" {...{\n          \"href\": \"#Backing-up-users\"\n        }}>{`Backing up users`}</a>{`: If you are using LDAP for user authentication, your LDAP server administrator makes users backup.  If you are storing users in your OpenShift cluster with htpasswod for example, then you need to make a backup those.`}</li>\n      <li parentName=\"ul\"><a parentName=\"li\" {...{\n          \"href\": \"#backing-up-resource-state\"\n        }}>{`Backing up resource state`}</a>{`: You need to make a back up of the resource state in case you delete the wrong deployment or others.`}</li>\n      <li parentName=\"ul\"><a parentName=\"li\" {...{\n          \"href\": \"#Recovering-from-lost-master-hosts\"\n        }}>{`Recovering from lost master host(s)`}</a>{`: If one or more master permanently loses, you need to recover those. `}</li>\n      <li parentName=\"ul\"><a parentName=\"li\" {...{\n          \"href\": \"#restoring-to-a-previous-cluster-state\"\n        }}>{`Restore cluster state`}</a>{`: In case an administrator such as SRE or DevOps Engineer deleted something critical, we need to restore your cluster to the previous state.`}</li>\n      <li parentName=\"ul\"><a parentName=\"li\" {...{\n          \"href\": \"#recovering-from-expired-control-plane-certificates\"\n        }}>{`Recovering from expired control plane certificates`}</a>{`: If the TLS certificates are not valid on the cluster member being replaced, then you need to recover from expired control plane certificates.  `}</li>\n      <li parentName=\"ul\"><a parentName=\"li\" {...{\n          \"href\": \"#Restore-procedures-and-test\"\n        }}>{`Restore procedures and test`}</a>{`: You should write a detailed, step-by-step procedure describing how to restore data from backups, and make sure all staff know where to find this document.`}</li>\n    </ul>\n    <h2>{`Day 1 Application`}</h2>\n    <p>{`As Day 1, Application backup tasks will cover the following 3 areas:`}</p>\n    <ul>\n      <li parentName=\"ul\">{`Stateless applications and/or the pod images are not normally backed up (the orchestration engine will automatically recreate a failed pod/container, or a new deployment task is initiated)`}<ul parentName=\"li\">\n          <li parentName=\"ul\">{`Apps can be redeployed from CI/CD`}</li>\n          <li parentName=\"ul\">{`Config YAMLs can be restored from version control (like Git)`}</li>\n        </ul></li>\n      <li parentName=\"ul\">{`Install, test and enable tools utilized for application backup types`}</li>\n      <li parentName=\"ul\">{`There are needs to backup services provided for the DevOps Engineer to utilize or consume for persistent data.  This can/will include component specific agents needed for some items. You need to ensure that the data is consistent, sometimes this require locking of the application before taking the backup.`}</li>\n    </ul>\n    <h2>{`Day 2 Application`}</h2>\n    <p>{`As Day 2, Application backup tasks can be broken down into 3 distinct areas:`}</p>\n    <ul>\n      <li parentName=\"ul\"><a parentName=\"li\" {...{\n          \"href\": \"#backing-up-resource-state\"\n        }}>{`Backing up resource state`}</a>{`: Ensuring that the deployment configuration is backed up (roles and rolebindings, quotas, templates, Etc.), such that the project can be recovered.  This can be split between the platform and application team in that there are some resources (i.e. an external build tool, external image repository, Etc.) that are not within the scope of the platform SRE team.  In this case, it is the responsibility of the Application team to ensure that these non-platform tools are backed up.  `}</li>\n      <li parentName=\"ul\"><a parentName=\"li\" {...{\n          \"href\": \"#backing-up-your-application-data\"\n        }}>{`Backing up your application data`}</a>{`: Applications that require stateful data (i.e. data stored in a No/SQL database or StatefulSets) are provided and managed by the DevOps Engineer (and SRE).`}</li>\n      <li parentName=\"ul\"><a parentName=\"li\" {...{\n          \"href\": \"#repository-backup-images-management\"\n        }}>{`Repository backup/Images management`}</a>{`: Any images used within the application must be backed up to ensure that the latest revision deployed is captured and backed up. A repository backup will normally satisfy this requirement. The image management including backup and build process is out of scope of this document.  `}</li>\n    </ul>\n    <h2>{`Mapping to Personas`}</h2>\n    <table>\n      <thead parentName=\"table\">\n        <tr parentName=\"thead\">\n          <th parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`No`}</th>\n          <th parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Persona`}</th>\n          <th parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`task`}</th>\n        </tr>\n      </thead>\n      <tbody parentName=\"table\">\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`1`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`SRE`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Backing up etcd data`}</td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`2`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`SRE`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Backing up storage`}</td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`3`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`SRE`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Backing up images`}</td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`4`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`SRE`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Backing up certificates`}</td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`5`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`SRE`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Backing up Services data`}</td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`6`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`SRE`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Backing up users`}</td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`7`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`SRE`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Backing up resource state`}</td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`8`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`SRE`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Recovering from lost master host(s)`}</td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`9`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`SRE`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Restoring to a previous cluster state`}</td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`10`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`SRE`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Recovering from expired control plane certificates`}</td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`11`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`SRE, DevOps Engineer`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Restore procedures and test`}</td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`12`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`SRE, DevOps Engineer`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Backing up resource state`}</td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`13`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`SRE, DevOps Engineer`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Backing up your application data`}</td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`14`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`SRE, DevOps Engineer`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Repository backup/images management`}</td>\n        </tr>\n      </tbody>\n    </table>\n    <a name=\"Backing-up-etcd-data\"></a>\n    <h2>{`Backing up etcd data: `}{`[ SRE ]`}</h2>\n    <p>{`The etcd is the key-value store for OpenShift Container Platform, which persists the state of all resource objects.`}<br parentName=\"p\"></br>{`\n`}{`Back up your cluster’s etcd data regularly and store in a secure location ideally outside the OpenShift Container Platform environment.  `}</p>\n    <p>{`Note that do NOT take an etcd backup before the first certificate rotation completes, which occurs 24 hours after installation, otherwise the backup will contain expired certificates.  `}</p>\n    <p>{`It is also recommended to take etcd backups during non-peak usage hours, as it is a blocking action.`}<br parentName=\"p\"></br>{`\n`}{`Once you have an etcd backup, you can recover from lost master hosts and restore to a previous cluster state.`}<br parentName=\"p\"></br>{`\n`}{`You can perform the etcd data backup process on any master host that has connectivity to the etcd cluster, where the proper certificates are provided.  `}</p>\n    <p>{`You can find out the procedure to back up etcd data in the official document.`}<br parentName=\"p\"></br>{`\n`}<a parentName=\"p\" {...{\n        \"href\": \"https://docs.openshift.com/container-platform/4.3/backup_and_restore/backing-up-etcd.html\"\n      }}>{`https://docs.openshift.com/container-platform/4.3/backup_and_restore/backing-up-etcd.html`}</a>{`  `}</p>\n    <a name=\"Backing-up-storage\"></a>\n    <h2>{`Backing up storage: `}{`[ SRE ]`}</h2>\n    <p>{`Stateful apps save data, mostly attached on storage (persistent volumes), and it contains all the information that apps need in order to run properly making it a priority to backup. While”Application Data” is the norm for what needs to be backed up for applications (see “Application Data Backups”, there are additional areas to be considered and they are lumped under the term “Storage”.  These essential items such as secrets (normally part of the etcd backup), certificates (once again, normal part of the etcd backup).  However, this can also include specific items such as application specific Software Defined Network (SDN configuration), Etc.  In summary, all configuration items needed to restore the application (from image, to platform configuration, to application data), must be included in your backup solution and plan`}</p>\n    <a name=\"Backing-up-images\"></a>\n    <h2>{`Images backup: `}{`[ SRE ]`}</h2>\n    <p>{`You can use either internal or external Image Registry to store your images. We discuss the image backup in a separate `}<a parentName=\"p\" {...{\n        \"href\": \"../Image/\"\n      }}>{`document`}</a>{`.  `}</p>\n    <p>{`When utilizing the internal/Red Hat provided Registry (installed via an Operator), the Registry is configured and utilizes a standard Persistent Volume.  However, while the standard “backup all persistent volumes”, still applies, the Image Registry should have its own set of SLOs and processes for backups.  As an example:`}</p>\n    <ul>\n      <li parentName=\"ul\">{`Image Registry backups will occur more frequently than other Persistent Volumes`}</li>\n      <li parentName=\"ul\">{`Image Registry backups will be triggered whenever there is a commit (Image added), to ensure minimal/no loss of data`}</li>\n      <li parentName=\"ul\">{`Image Registry backups will allow for the restoration of a single image (instead of a complete Persistent Volume restoration).`}</li>\n      <li parentName=\"ul\">{`Etc.  `}</li>\n    </ul>\n    <p>{`The takeaway from the above is that the Image Registry is a shared service (versus an application level), that your platform consumers are depending upon the operations team to maintain and ensure data recovery in the case of failures.`}</p>\n    <a name=\"Backing-up-certificate\"></a>\n    <h2>{`Certificate backup: `}{`[ SRE ]`}</h2>\n    <p>{`You have several TLS certificates in your OpenShift cluster. We discuss the certificate backup in a separate `}<a parentName=\"p\" {...{\n        \"href\": \"../Security/\"\n      }}>{`document`}</a>{`.  `}</p>\n    <a name=\"backing-up-services-data\"></a>\n    <h2>{`Backing up Services data: `}{`[ SRE ]`}</h2>\n    <p>{`In case you are using the following features which comes with OpenShift, you need to consider the persistent storage backup:`}</p>\n    <ul>\n      <li parentName=\"ul\"><strong parentName=\"li\">{`Monitoring`}</strong>{` (Prometheus and Alertmanager)`}</li>\n      <li parentName=\"ul\"><strong parentName=\"li\">{`Logging`}</strong>{` (Elasticsearch)`}</li>\n      <li parentName=\"ul\"><strong parentName=\"li\">{`Metering`}</strong>{` (Hive and Presto)`}</li>\n      <li parentName=\"ul\"><strong parentName=\"li\">{`Service Mesh`}</strong>{` (Elasticsearch)   `}</li>\n    </ul>\n    <a name=\"Backing-up-users\"></a>\n    <h2>{`Backing up users: `}{`[ SRE ]`}</h2>\n    <p>{`If you are using LDAP for user authentication, your LDAP server administrator makes users backup.  If you are storing users in your OpenShift cluster with htpasswod for example, then you need to make a backup those.  `}</p>\n    <a name=\"backing-up-resource-state\"></a>\n    <h2>{`Backing up resource state: `}{`[ DevOps Engineer ]`}</h2>\n    <p>{`Apart from etcd failures, there is also the question of saving the state of your individual resources. If you delete the wrong Deployment, for example, how would you re-create it?`}</p>\n    <p>{`You would manage your OpenShift resources declaratively, by applying YAML manifests stored in version control.`}<br parentName=\"p\"></br>{`\n`}{`In theory, then, to re-create (restore) the state of your resource, you should be able to check out the relevant version control repository, and apply all the resources in them. `}</p>\n    <p>{`Note:  Some of these items (i.e. build tools, image repositories, Etc.), may not be hosted or under the control of the Platform SREs.  In those cases, it is the responsibility of the Development Engineer to ensure a backup process is in place and tested.`}</p>\n    <p>{`Cloud Native DevOps with Kubernetes:`}<br parentName=\"p\"></br>{`\n`}<a parentName=\"p\" {...{\n        \"href\": \"https://learning.oreilly.com/library/view/cloud-native-devops/9781492040750/ch11.html#\"\n      }}>{`https://learning.oreilly.com/library/view/cloud-native-devops/9781492040750/ch11.html#`}</a>{`   `}</p>\n    <p>{`When utilizing the internal/Red Hat provided Build and Pipeline tools (installed via an Operator), these tools are configured and utilize a standard set of Persistent Volumes.  However, while the standard “backup all persistent volumes”, still applies, the Build & Pipeline tools should have its own set of SLOs and processes for backups.  As an example:`}</p>\n    <ul>\n      <li parentName=\"ul\">{`Backups will occur more frequently than other Persistent Volumes`}</li>\n      <li parentName=\"ul\">{`Backups will allow for the restoration of a single Application set of data (instead of a complete Persistent Volume restoration).`}</li>\n      <li parentName=\"ul\">{`Etc.  `}</li>\n    </ul>\n    <p>{`The takeaway from the above is that the Build and Pipeline tools are a shared service (versus an application level), that your platform consumers are depending upon the operations team to maintain and ensure data recovery in the case of failures. `}</p>\n    <a name=\"Recovering-from-lost-master-hosts\"></a>\n    <h2>{`Recovering from lost master hosts: `}{`[ SRE ]`}</h2>\n    <p>{`We talked about etcd database which we will make a backup. You need to understand a bit more detail about the etcd to prepare master hosts recovery including etcd.  `}</p>\n    <p>{`The `}<strong parentName=\"p\">{`etcd`}</strong>{` is designed to withstand machine failures. An etcd cluster automatically recovers from temporary failures (e.g., machine reboots) and tolerates up to (N-1)/2 permanent failures for a cluster of N members.`}<br parentName=\"p\"></br>{`\n`}{`When a member permanently fails, whether due to hardware failure or disk corruption, it loses access to the cluster.`}<br parentName=\"p\"></br>{`\n`}{`If the cluster permanently loses more than (N-1)/2 members then it disastrously fails, irrevocably losing quorum. Once quorum is lost, the cluster cannot reach consensus and therefore cannot continue accepting updates.`}<br parentName=\"p\"></br>{`\n`}<a parentName=\"p\" {...{\n        \"href\": \"https://github.com/etcd-io/etcd/blob/master/Documentation/op-guide/recovery.md\"\n      }}>{`https://github.com/etcd-io/etcd/blob/master/Documentation/op-guide/recovery.md`}</a>{`   `}</p>\n    <p>{`There are a few situations you can think of:`}</p>\n    <ul>\n      <li parentName=\"ul\">{`A single etcd member is failed. It assumes that there is still an etcd quorum in the cluster.`}</li>\n      <li parentName=\"ul\">{`A majority of your masters still available and have an etcd quorum, then follow the procedure to replace a single failed master host (etcd member).`}</li>\n      <li parentName=\"ul\">{`A majority of master hosts have been lost, leading to etcd quorum loss and the cluster going offline. It assumes that you have at least one healthy master host.`}</li>\n    </ul>\n    <p>{`For the fist and second scenarios above, your recovery procedure will be the same. For the 3rd scenario, you will have different recovery procedure.  See the official manual for procedures.`}<br parentName=\"p\"></br>{`\n`}{`Note:OpenShift 4.x requires minimum 3 master nodes where the etcd runs.`}</p>\n    <p>{`You can find out the procedure to recover from lost master hosts in the official document.`}<br parentName=\"p\"></br>{`\n`}<a parentName=\"p\" {...{\n        \"href\": \"https://docs.openshift.com/container-platform/4.3/backup_and_restore/replacing-failed-master.html\"\n      }}>{`https://docs.openshift.com/container-platform/4.3/backup_and_restore/replacing-failed-master.html`}</a>{`\n`}<a parentName=\"p\" {...{\n        \"href\": \"https://docs.openshift.com/container-platform/4.3/backup_and_restore/disaster_recovery/scenario-1-infra-recovery.html#dr-infrastructure-recovery\"\n      }}>{`https://docs.openshift.com/container-platform/4.3/backup_and_restore/disaster_recovery/scenario-1-infra-recovery.html#dr-infrastructure-recovery`}</a>{`  `}</p>\n    <a name=\"restoring-to-a-previous-cluster-state\"></a>\n    <h2>{`Restoring to a previous cluster state: `}{`[ SRE ]`}</h2>\n    <p>{`To restore the cluster to a previous state, you must have previously backed up etcd data by creating a snapshot.`}<br parentName=\"p\"></br>{`\n`}{`You will use the snapshot (a saved etcd backup) to restore back to a previous cluster state.  `}</p>\n    <p>{`For example, if an administrator (either SRE and/or DevOps Engineer) deletes something critical. As long as you have taken an etcd backup, you can restore your cluster to a previous state.`}</p>\n    <p>{`You can find out the procedure to restore to a previous cluster state in the official document.`}<br parentName=\"p\"></br>{`\n`}<a parentName=\"p\" {...{\n        \"href\": \"https://docs.openshift.com/container-platform/4.3/backup_and_restore/disaster_recovery/scenario-2-restoring-cluster-state.html\"\n      }}>{`https://docs.openshift.com/container-platform/4.3/backup_and_restore/disaster_recovery/scenario-2-restoring-cluster-state.html`}</a></p>\n    <a name=\"recovering-from-expired-control-plane-certificates\"></a>\n    <h2>{`Recovering from expired control plane certificates: `}{`[ SRE ]`}</h2>\n    <p>{`If the TLS certificates are not valid on the cluster member being replaced, then you need to recover from expired control plane certificates.\nAnother scenario is that if you shut down your cluster before the first certificate rotation, which occurs 24 hours after installation, your certificates will not be rotated and will expire. Then you need to recover from expired control plane certificates to access your cluster.  `}</p>\n    <p>{`You can find out the procedure to recover from expired control plane certificates in the official document.`}<br parentName=\"p\"></br>{`\n`}<a parentName=\"p\" {...{\n        \"href\": \"https://docs.openshift.com/container-platform/4.3/backup_and_restore/disaster_recovery/scenario-3-expired-certs.html#dr-recovering-expired-certs\"\n      }}>{`https://docs.openshift.com/container-platform/4.3/backup_and_restore/disaster_recovery/scenario-3-expired-certs.html#dr-recovering-expired-certs`}</a>{`   `}</p>\n    <a name=\"Restore-procedures-and-test\"></a>\n    <h2>{`Restore procedures and test: `}{`[ SRE / DevOps Engineer ]`}</h2>\n    <p>{`It’s not very likely that you’d lose the whole cluster. What’s more likely is that you (or your newest team member) might delete a namespace by accident, shut down a Deployment without meaning to, or specify the wrong set of labels to a kubectl delete command, removing more than you intended. Whatever the cause, it does happen.  `}</p>\n    <p>{`You should write a detailed, step-by-step procedure describing how to restore data from backups, and make sure all staff know where to find this document. When a disaster happens, it’s usually at an inconvenient time, the key people aren’t available, everyone’s in a panic, and your procedure should be so clear and precise that it can be carried out by someone who isn’t familiar with Kubernetes.  `}</p>\n    <p>{`Each month, run a restore test by having a different team member execute the restore procedure against a temporary cluster. This verifies both that your backups are good and that the restore procedure is correct, and makes sure everyone is familiar with how to do it.  `}</p>\n    <p>{`Cloud Native DevOps with Kubernetes:`}<br parentName=\"p\"></br>{`\n`}<a parentName=\"p\" {...{\n        \"href\": \"https://learning.oreilly.com/library/view/cloud-native-devops/9781492040750/ch11.html#\"\n      }}>{`https://learning.oreilly.com/library/view/cloud-native-devops/9781492040750/ch11.html#`}</a>{`  `}</p>\n    <a name=\"backing-up-your-application-data\"></a>\n    <h2>{`Backing up your application data: `}{`[ SRE / DevOps Engineer ]`}</h2>\n    <p>{`Backup strategy for applications running on kubernetes depends on application design (stateless vs stateful) and deployment process (CI/CD).`}<br parentName=\"p\"></br>{`\n`}{`Stateless application does not store any state data and simple re-deployment from from CI/CD pipeline or from YAML definition files should be sufficient to restore the application.`}<br parentName=\"p\"></br>{`\n`}{`Stateful apps on the other hand save data, mostly attached on `}<a parentName=\"p\" {...{\n        \"href\": \"https://kubernetes.io/docs/concepts/storage/persistent-volumes/\"\n      }}>{`persistent volumes`}</a>{`, and it is these volumes that contain all the information that apps need in order to run properly making it a priority to backup. A persistent volume (PV) is a cluster-wide resource used to store data in a way that it persists beyond the lifetime of a pod. There are many `}<a parentName=\"p\" {...{\n        \"href\": \"https://docs.openshift.com/container-platform/4.2/storage/understanding-persistent-storage.html#types-of-persistent-volumes_understanding-persistent-storage\"\n      }}>{`types of PVs`}</a>{` and some of them are backed up by networked storage system such as EBS, NFS or Ceph and other are locally attached storage like Local Volume or HostPath. The storage space in a PV is requested via another type of kubernetes object - Persistent Volume Claim (PVC). The PVC requests a PV with desired specification (size, speed, etc.) from Kubernetes and binds it then to a pod, where it can be mounted as a volume.  `}</p>\n    <p>{`Kubernetes persistent volumes by example`}<br parentName=\"p\"></br>{`\n`}<a parentName=\"p\" {...{\n        \"href\": \"http://kubernetesbyexample.com/pv/\"\n      }}>{`http://kubernetesbyexample.com/pv/`}</a></p>\n    <h3>{`Application specific backup`}</h3>\n    <p>{`Other option for application backup is to use standard backup tools specific for the workload using persistent volumes like `}<inlineCode parentName=\"p\">{`pg_dump`}</inlineCode>{` for Postgresql or `}<inlineCode parentName=\"p\">{`mongodump`}</inlineCode>{` for MongoDB.`}</p>\n    <a name=\"repository-backup-images-management\"></a>\n    <h2>{`Repository backup/Images management: `}{`[ SRE / DevOps Engineer ]`}</h2>\n    <p>{`Any images used within the application must be backed up to ensure that the latest revision deployed is captured and backed up. A repository backup will normally satisfy this requirement. The image management including backup and build process is out of scope of this document.  `}</p>\n    <p>{`As stated earlier, backing up the Image Registry and the Red Hat Provided Build & Pipeline tools is a key concept that should have specific SLOs and processes.  This satisfies the requirements for a platform provided set of tools and image retention.  However, if using external backup product then this comes under the scope of the team provide the backup service, to ensure Images within the registrey and backed up and restored\nFrom a restoration perspective; restoring the Image Repository would ensure any existing build or deployment scripts work as expected.  The restoration of the Red Hat provided Build and Pipeline tools data (and the tools themselves if necessary), would enable any Development team to recreate and deploy an image using the original build files.`}</p>\n    <h2>{`Implementing backup`}</h2>\n    <h2>{`Kubernetes out-of-the-box`}</h2>\n    <p>{`Kubernetes is not providing any specific function for backup. However, backup can be implemented using Operator Framework.`}<br parentName=\"p\"></br>{`\n`}{`Valero is an open source tool typically used for backup (see reference for details).    `}</p>\n    <h2>{`OpenShift out-of-the-box`}</h2>\n    <p>{`OpenShift does support etcd backup and restore.`}<br parentName=\"p\"></br>{`\n`}<a parentName=\"p\" {...{\n        \"href\": \"https://docs.openshift.com/container-platform/4.3/backup_and_restore/backing-up-etcd.html\"\n      }}>{`https://docs.openshift.com/container-platform/4.3/backup_and_restore/backing-up-etcd.html`}</a>{`  `}</p>\n    <p>{`You can implement your own operator to make a back up of your application by using Operator Framework.  `}</p>\n    <h2>{`IBM Cloud Pak for MCM`}</h2>\n    <h2>{`Backups on IBM or other Clouds`}</h2>\n    <p>{`With OpenShift on IBM Cloud (and similar to the managed OCP platforms which are a managed services), you cannot access the Masters to manage it.  In other words, the vendor will maintain the etcd on Master nodes. However, these backups do not allow for single Object restoration (i.e. deleting a secret by accident).  For that reason, it is impposible to recover these items so rigid procesess must be utilized to ensure that these sort of actions are recoverable.    `}</p>\n    <h2>{`Others`}</h2>\n    <p><strong parentName=\"p\">{`Velero`}</strong><br parentName=\"p\"></br>{`\n`}{`Velero is an open source tool to safely backup and restore, perform disaster recovery, and migrate Kubernetes cluster resources and persistent volumes.`}<br parentName=\"p\"></br>{`\n`}<a parentName=\"p\" {...{\n        \"href\": \"https://velero.io/\"\n      }}>{`https://velero.io/`}</a><br parentName=\"p\"></br>{`\n`}{`How Velero works: `}<a parentName=\"p\" {...{\n        \"href\": \"https://velero.io/docs/v1.2.0/how-velero-works/\"\n      }}>{`https://velero.io/docs/v1.2.0/how-velero-works/`}</a>{`  `}</p>\n    <p><strong parentName=\"p\">{`Stash`}</strong>{`\n`}<a parentName=\"p\" {...{\n        \"href\": \"https://stash.run/\"\n      }}>{`Stash`}</a>{`  `}</p>\n    <h2>{`Other consideration`}</h2>\n    <ul>\n      <li parentName=\"ul\">{`Platform backup SLOs and requirements.  This will include items such as etcd backed up weekly (since a new member can be installed and synched).  How often the repository will be backed up, how the change process will include the need to perform backups outside of schedule (i.e. Certificates updated, perform backup as part of that process such that a restoration will include the new certificates).  These requirements create the platform processes, SLOs and must meet the business continuity requirements for restoration due to a failure or data loss.  `}</li>\n    </ul>\n    <ul>\n      <li parentName=\"ul\">{`Mapping of the entire platform as to the technology and monitoring of backups.  I.e. Some Operators provide “backup” services embedded in the Operator and do not need external products.  Their configuration is performed via a CRD and the resulting backup can then be captured using additional products as necessary (i.e. Operator opens destination pool, performs backup but they pool may still be part of the platform storage system which will require additional technology to backup`}</li>\n    </ul>\n\n    </MDXLayout>;\n}\n;\nMDXContent.isMDXComponent = true;\n      "],"sourceRoot":""}