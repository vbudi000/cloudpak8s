{"componentChunkName":"component---src-pages-mcm-cp-4-mcm-mcm-bookinfo-index-mdx","path":"/mcm/cp4mcm_mcm_bookinfo/","result":{"pageContext":{"frontmatter":{"title":"MCM - Sample Bookinfo","weight":320},"relativePagePath":"/mcm/cp4mcm_mcm_bookinfo/index.mdx","titleType":"page","MdxNode":{"id":"711e0651-4e20-5d08-87a3-c37cb6e91803","children":[],"parent":"bce3d939-4244-5687-889d-0ee99a4794ae","internal":{"content":"---\ntitle: MCM - Sample Bookinfo\nweight: 320\n---\n\n##\tSubscription to a Helm Repository Channel\n\nIn this task, you define a **helm repository subscription channel** and **subscribe** to that **channel**. The channel is of type **HelmRepo**, meaning that the yaml you create will be deployed and stored in a Helm chart.\nVarious tasks associated are\n*\tLook at the bookinfo application\n*\tDeploy the channel\n*\tDefine the helm repo subscription model\n*\tDeploy the subscription\n*\tCheck the application\n\n### Bookinfo Application\n\nYou will use bookinfo application to deploy as a helm chart. The application is available as helm chart at *https://github.com/hybrid-ops/subscription-examples* along with the required resource definitions. You will this github as helm repository.\nNavigate to bookinfo folder, *https://github.com/hybrid-ops/subscription-examples/tree/master/bookinfo* for the required prerequsites. This folder has three files\n* prereqs.yaml - creates bookinfo namespace and creates the required image policy for bookinfo container\n* prereqs-ns.yaml - creates the namespaces bookinfo-entitilement and bookinfo-project for the channel and subscriptions\n* ip.yaml - Creates the required image security policy for the the example bookinfo product page.\n\nYou can copy the files to your local workstation and run the commands\n\nOnce, you log in to the OpenShift command line of **MCM Hub**, run the commands\n```\noc apply -f prereqs.yaml\noc apply -f prereqs-ns.yaml\noc apply -f ip.yaml\n```\n\n### Create the Channel\n\nYou will use the file, bookinfo-channel.yaml in *https://github.com/hybrid-ops/subscription-examples/tree/master/bookinfo-entitlement* to create the required the channel. You can download the file to run locally. This resource file defines the channel for helm repository **https://raw.githubusercontent.com/dymaczew/charts/master/repo/incubator/**\n\nLog in to the MCM Hub and run the command\n```\noc apply -f bookinfo-channel.yaml\n```\n\nCheck if the channel is created:\n```\noc project bookinfo-entitlement\noc get channel\n```\n\nThe output should look equivalent to\n\n```\nbookinfo-channel   HelmRepo   https://raw.githubusercontent.com/dymaczew/charts/master/repo/incubator/   122m\n```\n\nThis also can be varified in the console. Click the hambuger icon -> Manage Applications. Then launch the **Resources** tab which shows the channel that is just created.\n\n![Channel Image](/assets/img/cp4mcm/mcm-channel.jpg)\n\n### Create the Subscription\n\nYou will use the file, bookinfo-app.yaml in *https://github.com/hybrid-ops/subscription-examples/blob/master/bookinfo-project/bookinfo-app.yaml* to create the required subscription with a placement policy. If you examine the file, you will find  that the placement rule is set to **environment: Demo**. So, ensure that label is set on your target cluster where you want the application to deployed to.\nAlso, edit the file to modify the route according to your environment.\n\n![Modify Route](/assets/img/cp4mcm/mcm-modifyroute.jpg)\n\nAfter the modification of the route, run the command to deploy the application\n\n```\noc apply -f bookinfo-app.yaml\n```\n\nThe application should be deployed. You can check if the subscription is propogated\n\n```\noc get appsub --all-namespaces\n```\n\nThe output will look similar to\n\n```\nbookinfo-project   bookinfo-subscription   Propagated   141m\n```\n\nYou also can check the console. Click the hambuger icon -> Manage Applications -> Overview\n![Applications Overview](/assets/img/cp4mcm/mcm-applications.jpg)\n\nNow, click the application bookinfo-app to view the various resources involved with the subscription.\n![Application Details](/assets/img/cp4mcm/mcm-appdetails.jpg)\n\nHover over the placement rule to see the placement rule of the application\n![Placement Rule Visualization](/assets/img/cp4mcm/mcm-appdetails1.jpg)\n\nIf you don't see the application propogated, you may have to check the placement rule and ensure the rule matches to at least one cluster in your environment.\n","type":"Mdx","contentDigest":"db736a1841c9a33b592bbac4fabd057b","counter":479,"owner":"gatsby-plugin-mdx"},"frontmatter":{"title":"MCM - Sample Bookinfo","weight":320},"exports":{},"rawBody":"---\ntitle: MCM - Sample Bookinfo\nweight: 320\n---\n\n##\tSubscription to a Helm Repository Channel\n\nIn this task, you define a **helm repository subscription channel** and **subscribe** to that **channel**. The channel is of type **HelmRepo**, meaning that the yaml you create will be deployed and stored in a Helm chart.\nVarious tasks associated are\n*\tLook at the bookinfo application\n*\tDeploy the channel\n*\tDefine the helm repo subscription model\n*\tDeploy the subscription\n*\tCheck the application\n\n### Bookinfo Application\n\nYou will use bookinfo application to deploy as a helm chart. The application is available as helm chart at *https://github.com/hybrid-ops/subscription-examples* along with the required resource definitions. You will this github as helm repository.\nNavigate to bookinfo folder, *https://github.com/hybrid-ops/subscription-examples/tree/master/bookinfo* for the required prerequsites. This folder has three files\n* prereqs.yaml - creates bookinfo namespace and creates the required image policy for bookinfo container\n* prereqs-ns.yaml - creates the namespaces bookinfo-entitilement and bookinfo-project for the channel and subscriptions\n* ip.yaml - Creates the required image security policy for the the example bookinfo product page.\n\nYou can copy the files to your local workstation and run the commands\n\nOnce, you log in to the OpenShift command line of **MCM Hub**, run the commands\n```\noc apply -f prereqs.yaml\noc apply -f prereqs-ns.yaml\noc apply -f ip.yaml\n```\n\n### Create the Channel\n\nYou will use the file, bookinfo-channel.yaml in *https://github.com/hybrid-ops/subscription-examples/tree/master/bookinfo-entitlement* to create the required the channel. You can download the file to run locally. This resource file defines the channel for helm repository **https://raw.githubusercontent.com/dymaczew/charts/master/repo/incubator/**\n\nLog in to the MCM Hub and run the command\n```\noc apply -f bookinfo-channel.yaml\n```\n\nCheck if the channel is created:\n```\noc project bookinfo-entitlement\noc get channel\n```\n\nThe output should look equivalent to\n\n```\nbookinfo-channel   HelmRepo   https://raw.githubusercontent.com/dymaczew/charts/master/repo/incubator/   122m\n```\n\nThis also can be varified in the console. Click the hambuger icon -> Manage Applications. Then launch the **Resources** tab which shows the channel that is just created.\n\n![Channel Image](/assets/img/cp4mcm/mcm-channel.jpg)\n\n### Create the Subscription\n\nYou will use the file, bookinfo-app.yaml in *https://github.com/hybrid-ops/subscription-examples/blob/master/bookinfo-project/bookinfo-app.yaml* to create the required subscription with a placement policy. If you examine the file, you will find  that the placement rule is set to **environment: Demo**. So, ensure that label is set on your target cluster where you want the application to deployed to.\nAlso, edit the file to modify the route according to your environment.\n\n![Modify Route](/assets/img/cp4mcm/mcm-modifyroute.jpg)\n\nAfter the modification of the route, run the command to deploy the application\n\n```\noc apply -f bookinfo-app.yaml\n```\n\nThe application should be deployed. You can check if the subscription is propogated\n\n```\noc get appsub --all-namespaces\n```\n\nThe output will look similar to\n\n```\nbookinfo-project   bookinfo-subscription   Propagated   141m\n```\n\nYou also can check the console. Click the hambuger icon -> Manage Applications -> Overview\n![Applications Overview](/assets/img/cp4mcm/mcm-applications.jpg)\n\nNow, click the application bookinfo-app to view the various resources involved with the subscription.\n![Application Details](/assets/img/cp4mcm/mcm-appdetails.jpg)\n\nHover over the placement rule to see the placement rule of the application\n![Placement Rule Visualization](/assets/img/cp4mcm/mcm-appdetails1.jpg)\n\nIf you don't see the application propogated, you may have to check the placement rule and ensure the rule matches to at least one cluster in your environment.\n","fileAbsolutePath":"/home/travis/build/ibm-cloud-architecture/cloudpak8s/src/pages/mcm/cp4mcm_mcm_bookinfo/index.mdx"}}}}