{"componentChunkName":"component---src-pages-automation-install-ban-index-mdx","path":"/automation/install-ban/","result":{"pageContext":{"frontmatter":{"title":"Install IBM Business Automation Navigator","weight":800},"relativePagePath":"/automation/install-ban/index.mdx","titleType":"page","MdxNode":{"id":"751021c1-d675-52c8-84d3-52a18f396ab4","children":[],"parent":"db0e84be-cb0e-5fe6-bddf-c77fb48d3adb","internal":{"content":"---\ntitle: Install IBM Business Automation Navigator\nweight: 800\n---\n- \n# make sure there is a space after the - so that the TOC is generated\n{:toc}\n\n**(19.0.3 UPDATE NEEDED)**\n\n### Required services\nBefore installing IBM Business Automation Navigator (ICN), you should have the following pre-requisites in place:\n\n- Have privileged access to your DB2 database server. \n- Optionally, have access to your LDAP directory server.\n\nSee the [Shared services](/content/automation/shared-services) chapter for details on DB2 or LDAP installation, if needed.\n\n### Log in to you OCP cluster\nSee the [Prerequisites](/content/automation/pre-requisites) chapter for details on logging in to your OCP cluster.\n\n### Download the ICN PPA \nDownload the following PPA from [IBM Passport Advantage](https://www.ibm.com/software/passportadvantage) to your working-directory:\n\n- *IBM Cloud Pak for Automation v19.0.1 - Content Navigator for Certified Kubernetes Multiplatform Multilingual (CC221ML)*\n\nThe downloaded archive should be named `ICP4A19.0.1-fncn.tgz`.\n\n### Create the ICN project\nCreate a new OpenShift project for ICN with your desired name, e.g. `fncnproject`:\n\n```\noc new-project fncnproject\n```\n\nMake sure you are working from  your newly created ICN project, then grant the tiller server `edit` access to current project:\n\n```\noc project fncnproject\noc adm policy add-role-to-user edit \"system:serviceaccount:tiller:tiller\"\n```\n\n### Update the SCC\n```\noc adm policy add-scc-to-user privileged -z default\n\noc edit namespace fncnproject\n```\n\nWhile in the editor change these lines:\n - openshift.io/sa.scc.supplemental-groups: 1000330000/10000\n - openshift.io/sa.scc.uid-range: 1000330000/10000  \n\nTo look like this:\n - openshift.io/sa.scc.supplemental-groups: 50000\n - openshift.io/sa.scc.uid-range: 50001\n\nYou may get the following error if the SCC is not applied properly:\n```\nforbidden: unable to validate against any security context constraint: [fsGroup: Invalid value: []int64{50000}: 50000 is not an allowed group\n```\n\n### Push the FNCN images to the registry\n- Get the route to the docker service as described in the [Pre-requisites](/content/automation/pre-requisites) chapter, then login to your Docker registry:\n```\ndocker login -u $(oc whoami) -p $(oc whoami -t) <route-to-docker-service>\n```\n\n- Download the `loadimages.sh` script from the `icp4a` GitHub repo to your working directory:\n```\nwget https://raw.githubusercontent.com/icp4a/cert-kubernetes/19.0.1/scripts/loadimages.sh\nchmod +x loadimages.sh\n```\n\n- Load the ICN images (use `sudo` for on-prem cluster):\n```\n./loadimages.sh -p ICP4A19.0.1-fncn.tgz -r <route-to-docker-service>\n```\n\n### Create the database\n\nDownload [`createICNDB.sh`](/assets/automation/icn/db2/createICNDB.sh), [`DB2_CREATE_SCRIPT.sql`](/assets/automation/icn/db2/DB2_CREATE_SCRIPT.sql) and [`DB2_ONE_SCRIPT_ICNDB.sql`](/assets/automation/icn/db2/DB2_ONE_SCRIPT_ICNDB.sql) to your working directory on the database server and run the following commands:\n```\n## copy the db2 install script\nmkdir -p /data/db2fs\nmkdir -p /data/database/config\n\n## copy createICNDB.sh, DB2_CREATE_SCRIPT.sql and DB2_ONE_SCRIPT_ICNDB.sql files into folder /data/database/config\ncp createICNDB.sh DB2_CREATE_SCRIPT.sql DB2_ONE_SCRIPT_ICNDB.sql /data/database/config\n\nchown db2inst1:db2iadm1 /data/database/config\nchown db2inst1:db2iadm1 /data/database/config/*.sh\nchown db2inst1:db2iadm1 /data/database/config/*.sql\nchmod 755 /data/database/config/*.sh\n\nsu - db2inst1\ncd /data/database/config\n./createICNDB.sh -n ICNDB -s ICNSCHEMA -t ICNTS -u db2inst1 -a ceadmin\n\n## exit su mode\nexit\n```\n\n### Set up the persistent volumes\nRun the following commands to create the required PV folders in NFS, where `/data/persistentvolumes/` is the mounted directory of your NFS server:\n\n```\nmkdir -p /data/persistentvolumes/icn/configDropins/overrides\nmkdir -p /data/persistentvolumes/icn/logs\nmkdir -p /data/persistentvolumes/icn/plugins\nmkdir -p /data/persistentvolumes/icn/viewerlog\nmkdir -p /data/persistentvolumes/icn/viewercache\nmkdir -p /data/persistentvolumes/icn/aspera\n\nchown 50001:50000 /data/persistentvolumes/icn/configDropins/overrides\nchown 50001:50000 /data/persistentvolumes/icn/logs\nchown 50001:50000 /data/persistentvolumes/icn/plugins\nchown 50001:50000 /data/persistentvolumes/icn/viewerlog\nchown 50001:50000 /data/persistentvolumes/icn/viewercache\nchown 50001:50000 /data/persistentvolumes/icn/aspera\n```\n\nObtain the DB2 drivers from your database server installation. Copy them to the PVs. If your database server is local the commands should look like this: \n\n```\ncp /opt/ibm/db2/V11.1/java/db2jcc4.jar /data/persistentvolumes/icn/configDropins/overrides/\ncp /opt/ibm/db2/V11.1/java/db2jcc_license_cu.jar /data/persistentvolumes/icn/configDropins/overrides/\n```\n\nDownload all the ICN overrides files to your working directory \n - [`ICNDS.xml`](/assets/automation/icn/configDropins/overrides/ICNDS.xml) \n - [`DB2JCCDriver.xml`](/assets/automation/icn/configDropins/overrides/DB2JCCDriver.xml) \n - [`ldap_TDS.xml`](/assets/automation/icn/configDropins/overrides/ldap_TDS.xml)  \n\nIf you changed the database name in the database creation step above, you will also need to change it in `ICNDS.xml` here  \n\nEdit `ICNDS.xml`, replacing `<db-server-ip>` with the IP address of the database server, and possibly the database name.  \n`DB2JCCDriver.xml` contains the locations of the `db2jcc4.jar` and `db2jcc_license_cu.jar` files.  \nEdit `ldap_TDS.xml`, replacing `<ldap-server-ip>` with the IP address of the LDAP server.  \n\n```\ncp DB2JCCDriver.xml /data/persistentvolumes/icn/configDropins/overrides/\ncp ICNDS.xml /data/persistentvolumes/icn/configDropins/overrides/\ncp ldap_TDS.xml /data/persistentvolumes/icn/configDropins/overrides/\n```\n\nDownload the [`pv.yaml`](/assets/automation/icn/pv.yaml) configuration file to your working directory.\n\nReplace the placeholder `<ip-address>` placeholder with the IP address of NFS server and adjust the persistent volume path if needed.\n\nRun the following command to create the PVs:\n\n```\noc apply -f pv.yaml\n```\n\n### Create secrets\nThe Helm chart requires a secret in order to pull images from docker. You might need to change the address of the docker server.\n\n```\noc create secret docker-registry admin.registrykey --docker-server=docker-registry.default.svc:5000 --docker-username=$(oc whoami) --docker-password=$(oc whoami -t) -n fncnproject\n```\n\nNote that you cannot add the same secret more than once. If you need to delete a secret in order to create a new one, use the following command:  \n```\noc delete secret admin.registrykey -n fncnproject\n```\n\n### Install the ICN components\n- Download the [`values.yaml`](/assets/automation/icn/values.yaml) file to your working directory.\n\n- Download the Helm charts to your working directory:\n```\nwget https://github.com/icp4a/cert-kubernetes/raw/master/NAVIGATOR/helm-charts/ibm-dba-navigator-3.0.0.tgz\n```\n\n- Install the Helm charts:\n```\nhelm install ibm-dba-navigator-3.0.0.tgz --name navigator-prod-release --namespace fncnproject -f values.yaml\n```\n\n### Expose the ICN console service\nDownload the [`route.yaml`](/assets/automation/icn/route.yaml) file to your working directory and run the command:\n```\noc apply -f route.yaml\n```\nTo retrieve the ICN console service URL, open the `services` section on the OCP cluster console, select the desired ICN service, and go to the detail page to find the URL.\n\n```\noc get route -n openshift-console\n\n```\n\nwhich will return something like this:\n\n```\nNAME      HOST/PORT                                   PATH      SERVICES   PORT      TERMINATION          WILDCARD\nconsole   console.apps-cp4a-res.rtp.raleigh.ibm.com             console    https     reencrypt/Redirect   None\n```\n\nOpen the Host/Port in a browser. Select the ecmproject. On the left, select Networking, and the routes. This will give you the base URL for ICN. Append `/navigator` to that URL. That should take you to the ICN page. The username is `ceadmin` and the password is `Passw0rd`.\n\n\n### Post-install tasks\n\nSee the following step to complete the installation:\n- [Configuring IBM Business Automation Navigator in a container environment](https://www.ibm.com/support/knowledgecenter/en/SSYHZ8_18.0.x/com.ibm.dba.install/k8s_topics/tsk_ecmconfigbank8s.html)\n\n### Initialize your Navigator installation\nLogin to Navigator. Go to `Administration` panel from the `Main Menu`. Click on `Connections` then select the `Repositories` tab.\n\nCreate a repository: \n - Choose `FileNet Content Manager repository` as type. \n - The server URL must be your CPE service URL + `/wsi/FNCEWS40MTOM/`. This should look like: `https://cpe-prod-release-ibm-dba-contentservices-https-ecmproject.router.default.svc.cluster.local/wsi/FNCEWS40MTOM/`.\n - In the `Configuration Parameters` tab, set the `Entry template management` value to `Enabled`.\n \nCreate a `Desktop`.\n\n### Uninstall\nIf needed, run the following steps to uninstall ICN:\n```\nhelm delete navigator-prod-release --purge \noc delete -f route.yaml\noc delete secret admin.registrykey -n fncnproject\n```\n\nTo optionally delete the PVs\n```\noc delete pvc icn-asperastore-pvc\noc delete pvc icn-cfgstore-pvc\noc delete pvc icn-logstore-pvc\noc delete pvc icn-pluginstore-pvc\noc delete pvc icn-vw-cachestore-pvc\noc delete pvc icn-vw-logstore-pvc\n\noc delete -f pv.yaml\n```\n\nAsk your database administrator to remove the databases associated with ICN.\n\n### Troubleshooting\n\nCheck the pods for the ecmproject. This will show the overall health.\n\n```\noc get pods -n fncnproject\n```\n\n - Check for errors in the `./loadimages.sh` step earlier.  \n - The registry might have run out of room. \n - Verify you're pushing/pulling to/from the right registry in the docker console.\n - Verify Secret is not preventing you from pulling images. \n - Infrastructure might have evicted the registry pod.\n \nVerify both images were uploaded and are available to your project workspace.\n\n```\noc get imagestreams -n fncnproject\n```\n\nRun oc describe pod to gain insight into what's going on\n```\noc describe pod <pod name> -n fncnproject\n\n```\n\nRun oc logs to view the pod's log files\n```\noc logs <pod name> -n fncnproject\n\n```\n\n\n\n","type":"Mdx","contentDigest":"ff605b64dc5f059841bf42c4633e9d8f","counter":547,"owner":"gatsby-plugin-mdx"},"frontmatter":{"title":"Install IBM Business Automation Navigator","weight":800},"exports":{},"rawBody":"---\ntitle: Install IBM Business Automation Navigator\nweight: 800\n---\n- \n# make sure there is a space after the - so that the TOC is generated\n{:toc}\n\n**(19.0.3 UPDATE NEEDED)**\n\n### Required services\nBefore installing IBM Business Automation Navigator (ICN), you should have the following pre-requisites in place:\n\n- Have privileged access to your DB2 database server. \n- Optionally, have access to your LDAP directory server.\n\nSee the [Shared services](/content/automation/shared-services) chapter for details on DB2 or LDAP installation, if needed.\n\n### Log in to you OCP cluster\nSee the [Prerequisites](/content/automation/pre-requisites) chapter for details on logging in to your OCP cluster.\n\n### Download the ICN PPA \nDownload the following PPA from [IBM Passport Advantage](https://www.ibm.com/software/passportadvantage) to your working-directory:\n\n- *IBM Cloud Pak for Automation v19.0.1 - Content Navigator for Certified Kubernetes Multiplatform Multilingual (CC221ML)*\n\nThe downloaded archive should be named `ICP4A19.0.1-fncn.tgz`.\n\n### Create the ICN project\nCreate a new OpenShift project for ICN with your desired name, e.g. `fncnproject`:\n\n```\noc new-project fncnproject\n```\n\nMake sure you are working from  your newly created ICN project, then grant the tiller server `edit` access to current project:\n\n```\noc project fncnproject\noc adm policy add-role-to-user edit \"system:serviceaccount:tiller:tiller\"\n```\n\n### Update the SCC\n```\noc adm policy add-scc-to-user privileged -z default\n\noc edit namespace fncnproject\n```\n\nWhile in the editor change these lines:\n - openshift.io/sa.scc.supplemental-groups: 1000330000/10000\n - openshift.io/sa.scc.uid-range: 1000330000/10000  \n\nTo look like this:\n - openshift.io/sa.scc.supplemental-groups: 50000\n - openshift.io/sa.scc.uid-range: 50001\n\nYou may get the following error if the SCC is not applied properly:\n```\nforbidden: unable to validate against any security context constraint: [fsGroup: Invalid value: []int64{50000}: 50000 is not an allowed group\n```\n\n### Push the FNCN images to the registry\n- Get the route to the docker service as described in the [Pre-requisites](/content/automation/pre-requisites) chapter, then login to your Docker registry:\n```\ndocker login -u $(oc whoami) -p $(oc whoami -t) <route-to-docker-service>\n```\n\n- Download the `loadimages.sh` script from the `icp4a` GitHub repo to your working directory:\n```\nwget https://raw.githubusercontent.com/icp4a/cert-kubernetes/19.0.1/scripts/loadimages.sh\nchmod +x loadimages.sh\n```\n\n- Load the ICN images (use `sudo` for on-prem cluster):\n```\n./loadimages.sh -p ICP4A19.0.1-fncn.tgz -r <route-to-docker-service>\n```\n\n### Create the database\n\nDownload [`createICNDB.sh`](/assets/automation/icn/db2/createICNDB.sh), [`DB2_CREATE_SCRIPT.sql`](/assets/automation/icn/db2/DB2_CREATE_SCRIPT.sql) and [`DB2_ONE_SCRIPT_ICNDB.sql`](/assets/automation/icn/db2/DB2_ONE_SCRIPT_ICNDB.sql) to your working directory on the database server and run the following commands:\n```\n## copy the db2 install script\nmkdir -p /data/db2fs\nmkdir -p /data/database/config\n\n## copy createICNDB.sh, DB2_CREATE_SCRIPT.sql and DB2_ONE_SCRIPT_ICNDB.sql files into folder /data/database/config\ncp createICNDB.sh DB2_CREATE_SCRIPT.sql DB2_ONE_SCRIPT_ICNDB.sql /data/database/config\n\nchown db2inst1:db2iadm1 /data/database/config\nchown db2inst1:db2iadm1 /data/database/config/*.sh\nchown db2inst1:db2iadm1 /data/database/config/*.sql\nchmod 755 /data/database/config/*.sh\n\nsu - db2inst1\ncd /data/database/config\n./createICNDB.sh -n ICNDB -s ICNSCHEMA -t ICNTS -u db2inst1 -a ceadmin\n\n## exit su mode\nexit\n```\n\n### Set up the persistent volumes\nRun the following commands to create the required PV folders in NFS, where `/data/persistentvolumes/` is the mounted directory of your NFS server:\n\n```\nmkdir -p /data/persistentvolumes/icn/configDropins/overrides\nmkdir -p /data/persistentvolumes/icn/logs\nmkdir -p /data/persistentvolumes/icn/plugins\nmkdir -p /data/persistentvolumes/icn/viewerlog\nmkdir -p /data/persistentvolumes/icn/viewercache\nmkdir -p /data/persistentvolumes/icn/aspera\n\nchown 50001:50000 /data/persistentvolumes/icn/configDropins/overrides\nchown 50001:50000 /data/persistentvolumes/icn/logs\nchown 50001:50000 /data/persistentvolumes/icn/plugins\nchown 50001:50000 /data/persistentvolumes/icn/viewerlog\nchown 50001:50000 /data/persistentvolumes/icn/viewercache\nchown 50001:50000 /data/persistentvolumes/icn/aspera\n```\n\nObtain the DB2 drivers from your database server installation. Copy them to the PVs. If your database server is local the commands should look like this: \n\n```\ncp /opt/ibm/db2/V11.1/java/db2jcc4.jar /data/persistentvolumes/icn/configDropins/overrides/\ncp /opt/ibm/db2/V11.1/java/db2jcc_license_cu.jar /data/persistentvolumes/icn/configDropins/overrides/\n```\n\nDownload all the ICN overrides files to your working directory \n - [`ICNDS.xml`](/assets/automation/icn/configDropins/overrides/ICNDS.xml) \n - [`DB2JCCDriver.xml`](/assets/automation/icn/configDropins/overrides/DB2JCCDriver.xml) \n - [`ldap_TDS.xml`](/assets/automation/icn/configDropins/overrides/ldap_TDS.xml)  \n\nIf you changed the database name in the database creation step above, you will also need to change it in `ICNDS.xml` here  \n\nEdit `ICNDS.xml`, replacing `<db-server-ip>` with the IP address of the database server, and possibly the database name.  \n`DB2JCCDriver.xml` contains the locations of the `db2jcc4.jar` and `db2jcc_license_cu.jar` files.  \nEdit `ldap_TDS.xml`, replacing `<ldap-server-ip>` with the IP address of the LDAP server.  \n\n```\ncp DB2JCCDriver.xml /data/persistentvolumes/icn/configDropins/overrides/\ncp ICNDS.xml /data/persistentvolumes/icn/configDropins/overrides/\ncp ldap_TDS.xml /data/persistentvolumes/icn/configDropins/overrides/\n```\n\nDownload the [`pv.yaml`](/assets/automation/icn/pv.yaml) configuration file to your working directory.\n\nReplace the placeholder `<ip-address>` placeholder with the IP address of NFS server and adjust the persistent volume path if needed.\n\nRun the following command to create the PVs:\n\n```\noc apply -f pv.yaml\n```\n\n### Create secrets\nThe Helm chart requires a secret in order to pull images from docker. You might need to change the address of the docker server.\n\n```\noc create secret docker-registry admin.registrykey --docker-server=docker-registry.default.svc:5000 --docker-username=$(oc whoami) --docker-password=$(oc whoami -t) -n fncnproject\n```\n\nNote that you cannot add the same secret more than once. If you need to delete a secret in order to create a new one, use the following command:  \n```\noc delete secret admin.registrykey -n fncnproject\n```\n\n### Install the ICN components\n- Download the [`values.yaml`](/assets/automation/icn/values.yaml) file to your working directory.\n\n- Download the Helm charts to your working directory:\n```\nwget https://github.com/icp4a/cert-kubernetes/raw/master/NAVIGATOR/helm-charts/ibm-dba-navigator-3.0.0.tgz\n```\n\n- Install the Helm charts:\n```\nhelm install ibm-dba-navigator-3.0.0.tgz --name navigator-prod-release --namespace fncnproject -f values.yaml\n```\n\n### Expose the ICN console service\nDownload the [`route.yaml`](/assets/automation/icn/route.yaml) file to your working directory and run the command:\n```\noc apply -f route.yaml\n```\nTo retrieve the ICN console service URL, open the `services` section on the OCP cluster console, select the desired ICN service, and go to the detail page to find the URL.\n\n```\noc get route -n openshift-console\n\n```\n\nwhich will return something like this:\n\n```\nNAME      HOST/PORT                                   PATH      SERVICES   PORT      TERMINATION          WILDCARD\nconsole   console.apps-cp4a-res.rtp.raleigh.ibm.com             console    https     reencrypt/Redirect   None\n```\n\nOpen the Host/Port in a browser. Select the ecmproject. On the left, select Networking, and the routes. This will give you the base URL for ICN. Append `/navigator` to that URL. That should take you to the ICN page. The username is `ceadmin` and the password is `Passw0rd`.\n\n\n### Post-install tasks\n\nSee the following step to complete the installation:\n- [Configuring IBM Business Automation Navigator in a container environment](https://www.ibm.com/support/knowledgecenter/en/SSYHZ8_18.0.x/com.ibm.dba.install/k8s_topics/tsk_ecmconfigbank8s.html)\n\n### Initialize your Navigator installation\nLogin to Navigator. Go to `Administration` panel from the `Main Menu`. Click on `Connections` then select the `Repositories` tab.\n\nCreate a repository: \n - Choose `FileNet Content Manager repository` as type. \n - The server URL must be your CPE service URL + `/wsi/FNCEWS40MTOM/`. This should look like: `https://cpe-prod-release-ibm-dba-contentservices-https-ecmproject.router.default.svc.cluster.local/wsi/FNCEWS40MTOM/`.\n - In the `Configuration Parameters` tab, set the `Entry template management` value to `Enabled`.\n \nCreate a `Desktop`.\n\n### Uninstall\nIf needed, run the following steps to uninstall ICN:\n```\nhelm delete navigator-prod-release --purge \noc delete -f route.yaml\noc delete secret admin.registrykey -n fncnproject\n```\n\nTo optionally delete the PVs\n```\noc delete pvc icn-asperastore-pvc\noc delete pvc icn-cfgstore-pvc\noc delete pvc icn-logstore-pvc\noc delete pvc icn-pluginstore-pvc\noc delete pvc icn-vw-cachestore-pvc\noc delete pvc icn-vw-logstore-pvc\n\noc delete -f pv.yaml\n```\n\nAsk your database administrator to remove the databases associated with ICN.\n\n### Troubleshooting\n\nCheck the pods for the ecmproject. This will show the overall health.\n\n```\noc get pods -n fncnproject\n```\n\n - Check for errors in the `./loadimages.sh` step earlier.  \n - The registry might have run out of room. \n - Verify you're pushing/pulling to/from the right registry in the docker console.\n - Verify Secret is not preventing you from pulling images. \n - Infrastructure might have evicted the registry pod.\n \nVerify both images were uploaded and are available to your project workspace.\n\n```\noc get imagestreams -n fncnproject\n```\n\nRun oc describe pod to gain insight into what's going on\n```\noc describe pod <pod name> -n fncnproject\n\n```\n\nRun oc logs to view the pod's log files\n```\noc logs <pod name> -n fncnproject\n\n```\n\n\n\n","fileAbsolutePath":"/Users/davethiessen/github/cloudpak8s/src/pages/automation/install-ban/index.mdx"}}}}